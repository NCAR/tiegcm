       module B_bmed_model_mod
       
         use common_model_mod, only: MMX,MXNMX,ITHMX,NQ,pi,fit_by_MLT
       
         implicit none
       
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Data type
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         character(len=80), parameter :: 
     |       data_type_dB1= 'dBd1_S',
     |       data_type_dB2= 'dBd2_S',
     |       data_type_MagPot= 'MagPot',
     |       data_type_FAC= 'FAC'
       
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Arrays for fit coefficients:
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Number of fit coefficients for each mlat:
         integer :: B_Bmed_nfit
         ! Fit coefficients (dimension nmlat x nfit):
         real, allocatable, dimension(:,:) :: B_Bmed_b_Ed1,B_Bmed_b_Ed2 ! nmlat x nfit
         ! Interpolated fit coefficients (dimension nfit):
         real, allocatable, dimension(:) :: b_interp_Ed1,b_interp_Ed2
         ! Fitting functions (dimension nfit):
         real, allocatable, dimension(:) :: x
         ! Fit coefficients averaged over the pole (dimension nfit):
         real, allocatable, dimension(:) :: b_90_Ed1,b_90_Ed2
         ! Number of fit functions used by fit_data:
         integer, parameter :: B_Bmed_number_of_MLT_coeffs = 7,
     |        B_Bmed_number_of_Btrans_coeffs = 1,
     |        B_Bmed_number_of_imf_angle_coeffs = 2,
     |        B_Bmed_number_of_sinT_coeffs = 2
         ! Indices:
         integer :: imlat,ifit
         ! FAC:
         real :: Bmed_N_AO(NQ),Bmed_FAC_AO(-MMX:MMX,MXNMX,
     |         B_Bmed_number_of_Btrans_coeffs,
     |         B_Bmed_number_of_imf_angle_coeffs, 
     |         B_Bmed_number_of_sinT_coeffs)
       
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Data smoothing:
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         logical :: do_smooth
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Results
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         real :: value, value_Ed1, value_Ed2
         logical :: value_found, fit_found
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Qgen variables
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         real ::  B_Bmed_AO(-MMX:MMX,MXNMX,
     |      B_Bmed_number_of_Btrans_coeffs,
     |      B_Bmed_number_of_imf_angle_coeffs,
     |      B_Bmed_number_of_sinT_coeffs)
         real :: B_Bmed_Q(NQ,0:ITHMX),B_Bmed_DQ(NQ,0:ITHMX)
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Coeffmerge
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         integer, parameter :: 
     |       B_Bmed_fit_by_Btrans = 0,
     |       B_Bmed_fit_by_imf_angle = 1,
     |       B_Bmed_fit_by_sinT = 1
       
       contains
       
         function find_MLT_function (index,MLT_in) result (MLT_fxn_out)
           integer :: index
           real :: MLT_in, MLT_fxn_out
       
           select case (index)
           case (0) 
              MLT_fxn_out = 1.
           case (1)
              MLT_fxn_out = 1.
           case (2)
              MLT_fxn_out = cos(pi*MLT_in/12.)
           case (3)
              MLT_fxn_out = sin(pi*MLT_in/12.)
           case (4)
              MLT_fxn_out = cos(pi*MLT_in/6.)
           case (5)
              MLT_fxn_out = sin(pi*MLT_in/6.)
           case (6)
              MLT_fxn_out = cos(pi*MLT_in/4.)
           case (7)
              MLT_fxn_out = sin(pi*MLT_in/4.)
           end select
         end function find_MLT_function
       
         function find_Btrans_function (index,Btrans_in) 
     |                result (Btrans_fxn_out)
           integer :: index
           real :: Btrans_in, Btrans_fxn_out
       
           select case (index)
           case (0) 
              Btrans_fxn_out = 1.
           case (1)
              Btrans_fxn_out = 1.
           case (2)
              Btrans_fxn_out = Btrans_in/5.2 - 1.
           case (3)
              Btrans_fxn_out = (Btrans_in/5.2 - 1.)**2
           end select
         end function find_Btrans_function
       
         function find_imf_angle_function (index,imf_angle_in) 
     |         result (imf_angle_fxn_out)
           integer :: index
           real :: imf_angle_in, imf_angle_fxn_out
       
           select case (index)
           case (0) 
              imf_angle_fxn_out = 1.
           case (1)
              imf_angle_fxn_out = 1.-cos(imf_angle_in)
           case (2)
              imf_angle_fxn_out = sin(imf_angle_in)
           case (3)
              imf_angle_fxn_out = sin(imf_angle_in)
           case (4)
              imf_angle_fxn_out = cos(2.*imf_angle_in)
           case (5)
              imf_angle_fxn_out = sin(2.*imf_angle_in)
           end select
         end function find_imf_angle_function
       
         function find_sinT_function (index,sinT_in)  
     |         result (sinT_fxn_out)
           integer :: index
           real :: sinT_in, sinT_fxn_out
       
           select case (index)
           case (0) 
              sinT_fxn_out = 1.
           case (1)
              sinT_fxn_out = 1.
           case (2)
              sinT_fxn_out = sinT_in-0.8*sinT_in**2
           case (3)
              sinT_fxn_out = sinT_in**2
           end select
         end function find_sinT_function
       
       end module B_bmed_model_mod
       
       !---------------------------------------------------------------------------
       !---------------------------------------------------------------------------
       
       module B_bmed_coeffmerge_mod
       
         ! Merged coefficients from dB_m and dB_r to one set
         ! of Fourier series coefficients
       
         ! This module file created 2006/11/13.
         ! with the following parameters:
         !   for 81249-83047 period 
         !   fit_by_Btrans = 0
         !   fit_by_imf_angle = 1
         !   fit_by_sinT = 1
         !   mlat_resolution = 2
       
         ! To use this module, include the statement
         !   use coeffmerge_mod
         ! and the subroutine call
         !   call fill_coeff_arrays
         ! in Fortran90 programs.
         ! 
         ! Compilation will be slow; a Makefile is suggested!
         implicit none
         save
         real,  dimension( 23, 28) :: dB_d1 
         real,  dimension( 23, 28) :: dB_d2 
         real,  dimension( 23) :: min_mlat,max_mlat!,average_mlat
       
       contains
       
         subroutine B_bmed_fill_coeff_arrays
       
           ! Fill dB_d1 arrays:  
           dB_d1(  1,  1) =  -0.2662    
           dB_d1(  1,  2) =  -0.8040    
           dB_d1(  1,  3) =   0.1526    
           dB_d1(  1,  4) =   -2.914    
           dB_d1(  1,  5) =  -0.5321    
           dB_d1(  1,  6) =    6.787    
           dB_d1(  1,  7) =  -0.3771    
           dB_d1(  1,  8) =   -7.370    
           dB_d1(  1,  9) =   0.6719    
           dB_d1(  1, 10) =   -9.988    
           dB_d1(  1, 11) =   -3.226    
           dB_d1(  1, 12) =   -4.155    
           dB_d1(  1, 13) =  -0.3508    
           dB_d1(  1, 14) =   -1.921    
           dB_d1(  1, 15) =   0.3507    
           dB_d1(  1, 16) =   -1.524    
           dB_d1(  1, 17) =   0.1732    
           dB_d1(  1, 18) =    1.799    
           dB_d1(  1, 19) =  -0.6663    
           dB_d1(  1, 20) =    1.226    
           dB_d1(  1, 21) =  -0.3400E-01
           dB_d1(  1, 22) =   -2.945    
           dB_d1(  1, 23) =   0.5105    
           dB_d1(  1, 24) =    2.901    
           dB_d1(  1, 25) =   0.6800E-01
           dB_d1(  1, 26) =   0.8650E-01
           dB_d1(  1, 27) =   -1.462    
           dB_d1(  1, 28) =    2.140    
           dB_d1(  2,  1) =   -1.875    
           dB_d1(  2,  2) =   -1.212    
           dB_d1(  2,  3) =  -0.4419    
           dB_d1(  2,  4) =   -4.022    
           dB_d1(  2,  5) =  -0.3274    
           dB_d1(  2,  6) =    7.533    
           dB_d1(  2,  7) =   0.5266    
           dB_d1(  2,  8) =   -7.225    
           dB_d1(  2,  9) =   0.1725    
           dB_d1(  2, 10) =   -15.10    
           dB_d1(  2, 11) =   -2.102    
           dB_d1(  2, 12) =   -1.377    
           dB_d1(  2, 13) =   0.1125    
           dB_d1(  2, 14) =   -2.433    
           dB_d1(  2, 15) =   0.8381    
           dB_d1(  2, 16) =    2.261    
           dB_d1(  2, 17) =  -0.3695    
           dB_d1(  2, 18) =   0.8540    
           dB_d1(  2, 19) =  -0.4909    
           dB_d1(  2, 20) =    3.372    
           dB_d1(  2, 21) =  -0.8726    
           dB_d1(  2, 22) =   -5.983    
           dB_d1(  2, 23) =   0.6850E-01
           dB_d1(  2, 24) =    6.257    
           dB_d1(  2, 25) =   0.1765    
           dB_d1(  2, 26) =    3.020    
           dB_d1(  2, 27) =  -0.9657    
           dB_d1(  2, 28) =   0.1368    
           dB_d1(  3,  1) =   -2.272    
           dB_d1(  3,  2) =  -0.4225    
           dB_d1(  3,  3) =   0.5400E-02
           dB_d1(  3,  4) =   -7.145    
           dB_d1(  3,  5) =  -0.6200E-01
           dB_d1(  3,  6) =    10.61    
           dB_d1(  3,  7) =   0.2850    
           dB_d1(  3,  8) =   -10.62    
           dB_d1(  3,  9) =  -0.6442    
           dB_d1(  3, 10) =   -21.18    
           dB_d1(  3, 11) =   -3.237    
           dB_d1(  3, 12) =    2.693    
           dB_d1(  3, 13) =  -0.3140    
           dB_d1(  3, 14) =   -8.730    
           dB_d1(  3, 15) =   0.8508    
           dB_d1(  3, 16) =    1.830    
           dB_d1(  3, 17) =   0.5970    
           dB_d1(  3, 18) =   -3.745    
           dB_d1(  3, 19) =   -1.243    
           dB_d1(  3, 20) =    3.244    
           dB_d1(  3, 21) =  -0.3380    
           dB_d1(  3, 22) =   -10.47    
           dB_d1(  3, 23) =   0.8140    
           dB_d1(  3, 24) =    7.772    
           dB_d1(  3, 25) =  -0.3934    
           dB_d1(  3, 26) =    6.437    
           dB_d1(  3, 27) =  -0.3200    
           dB_d1(  3, 28) =    3.910    
           dB_d1(  4,  1) =   -2.532    
           dB_d1(  4,  2) =   -1.714    
           dB_d1(  4,  3) =   0.8565    
           dB_d1(  4,  4) =   -7.614    
           dB_d1(  4,  5) =   0.6700    
           dB_d1(  4,  6) =    8.177    
           dB_d1(  4,  7) =   0.1957    
           dB_d1(  4,  8) =   -12.83    
           dB_d1(  4,  9) =   -2.888    
           dB_d1(  4, 10) =   -26.29    
           dB_d1(  4, 11) =   -4.168    
           dB_d1(  4, 12) =    1.887    
           dB_d1(  4, 13) =   0.4805    
           dB_d1(  4, 14) =   -11.38    
           dB_d1(  4, 15) =  -0.2236    
           dB_d1(  4, 16) =    2.857    
           dB_d1(  4, 17) =    2.229    
           dB_d1(  4, 18) =   -1.545    
           dB_d1(  4, 19) =  -0.9031    
           dB_d1(  4, 20) =    3.755    
           dB_d1(  4, 21) =   0.8920    
           dB_d1(  4, 22) =   -11.23    
           dB_d1(  4, 23) =    1.451    
           dB_d1(  4, 24) =    9.145    
           dB_d1(  4, 25) =   0.6500    
           dB_d1(  4, 26) =    7.796    
           dB_d1(  4, 27) =   0.3295    
           dB_d1(  4, 28) =    4.219    
           dB_d1(  5,  1) =   -2.610    
           dB_d1(  5,  2) =   -1.513    
           dB_d1(  5,  3) =    1.764    
           dB_d1(  5,  4) =   -5.066    
           dB_d1(  5,  5) =    1.781    
           dB_d1(  5,  6) =    10.63    
           dB_d1(  5,  7) =  -0.8348    
           dB_d1(  5,  8) =   -12.78    
           dB_d1(  5,  9) =   -5.578    
           dB_d1(  5, 10) =   -31.95    
           dB_d1(  5, 11) =   -4.509    
           dB_d1(  5, 12) =    2.674    
           dB_d1(  5, 13) =   0.6495    
           dB_d1(  5, 14) =   -11.13    
           dB_d1(  5, 15) =   0.3300    
           dB_d1(  5, 16) =    8.434    
           dB_d1(  5, 17) =    3.446    
           dB_d1(  5, 18) =    1.625    
           dB_d1(  5, 19) =  -0.1155    
           dB_d1(  5, 20) =    10.12    
           dB_d1(  5, 21) =    1.087    
           dB_d1(  5, 22) =   -8.411    
           dB_d1(  5, 23) =    2.609    
           dB_d1(  5, 24) =    8.038    
           dB_d1(  5, 25) =    1.970    
           dB_d1(  5, 26) =    5.180    
           dB_d1(  5, 27) =    1.938    
           dB_d1(  5, 28) =    2.970    
           dB_d1(  6,  1) =  -0.4717    
           dB_d1(  6,  2) =   -2.303    
           dB_d1(  6,  3) =    1.284    
           dB_d1(  6,  4) =  -0.1250    
           dB_d1(  6,  5) =    5.606    
           dB_d1(  6,  6) =    10.63    
           dB_d1(  6,  7) =   -1.917    
           dB_d1(  6,  8) =   -21.23    
           dB_d1(  6,  9) =   -5.015    
           dB_d1(  6, 10) =   -34.35    
           dB_d1(  6, 11) =   -1.583    
           dB_d1(  6, 12) =    9.511    
           dB_d1(  6, 13) =  -0.1045    
           dB_d1(  6, 14) =   -11.62    
           dB_d1(  6, 15) =    2.114    
           dB_d1(  6, 16) =    14.10    
           dB_d1(  6, 17) =    2.677    
           dB_d1(  6, 18) =    2.210    
           dB_d1(  6, 19) =  -0.1520    
           dB_d1(  6, 20) =    9.876    
           dB_d1(  6, 21) =   0.5235    
           dB_d1(  6, 22) =   -7.595    
           dB_d1(  6, 23) =    3.141    
           dB_d1(  6, 24) =    7.064    
           dB_d1(  6, 25) =    1.037    
           dB_d1(  6, 26) =    6.625    
           dB_d1(  6, 27) =    2.942    
           dB_d1(  6, 28) =   0.7915    
           dB_d1(  7,  1) =    2.233    
           dB_d1(  7,  2) =    4.030    
           dB_d1(  7,  3) =   0.3757    
           dB_d1(  7,  4) =   0.4100    
           dB_d1(  7,  5) =    13.39    
           dB_d1(  7,  6) =    13.88    
           dB_d1(  7,  7) =   -2.232    
           dB_d1(  7,  8) =   -30.39    
           dB_d1(  7,  9) =   -2.220    
           dB_d1(  7, 10) =   -25.97    
           dB_d1(  7, 11) =    3.836    
           dB_d1(  7, 12) =    22.51    
           dB_d1(  7, 13) =   -3.551    
           dB_d1(  7, 14) =   -14.24    
           dB_d1(  7, 15) =   0.9703    
           dB_d1(  7, 16) =    17.18    
           dB_d1(  7, 17) =   0.6810    
           dB_d1(  7, 18) =    2.875    
           dB_d1(  7, 19) =   -1.570    
           dB_d1(  7, 20) =    6.075    
           dB_d1(  7, 21) =   0.8750    
           dB_d1(  7, 22) =   -3.955    
           dB_d1(  7, 23) =    2.114    
           dB_d1(  7, 24) =  -0.5450    
           dB_d1(  7, 25) =   -2.583    
           dB_d1(  7, 26) =  -0.5650    
           dB_d1(  7, 27) =    1.085    
           dB_d1(  7, 28) =    5.584    
           dB_d1(  8,  1) =    4.353    
           dB_d1(  8,  2) =   -1.520    
           dB_d1(  8,  3) =   -2.223    
           dB_d1(  8,  4) =   -4.635    
           dB_d1(  8,  5) =    14.50    
           dB_d1(  8,  6) =   -8.410    
           dB_d1(  8,  7) =   -1.349    
           dB_d1(  8,  8) =   -27.53    
           dB_d1(  8,  9) =   -6.833    
           dB_d1(  8, 10) =   -17.76    
           dB_d1(  8, 11) =    5.828    
           dB_d1(  8, 12) =    29.39    
           dB_d1(  8, 13) =   -5.766    
           dB_d1(  8, 14) =   -19.77    
           dB_d1(  8, 15) =   0.9880    
           dB_d1(  8, 16) =    26.31    
           dB_d1(  8, 17) =   -2.133    
           dB_d1(  8, 18) =    8.325    
           dB_d1(  8, 19) =   -3.227    
           dB_d1(  8, 20) =    6.650    
           dB_d1(  8, 21) =  -0.8950    
           dB_d1(  8, 22) =   -5.230    
           dB_d1(  8, 23) =   -1.561    
           dB_d1(  8, 24) =    5.015    
           dB_d1(  8, 25) =   -2.454    
           dB_d1(  8, 26) =    18.23    
           dB_d1(  8, 27) =   -1.415    
           dB_d1(  8, 28) =    5.055    
           dB_d1(  9,  1) =    8.345    
           dB_d1(  9,  2) =   -13.63    
           dB_d1(  9,  3) =   -7.083    
           dB_d1(  9,  4) =   -5.895    
           dB_d1(  9,  5) =    9.750    
           dB_d1(  9,  6) =   -47.65    
           dB_d1(  9,  7) =   -4.135    
           dB_d1(  9,  8) =   -28.01    
           dB_d1(  9,  9) =   -28.56    
           dB_d1(  9, 10) =   -13.52    
           dB_d1(  9, 11) =    9.191    
           dB_d1(  9, 12) =    38.08    
           dB_d1(  9, 13) =   -6.755    
           dB_d1(  9, 14) =   -21.69    
           dB_d1(  9, 15) =   -1.603    
           dB_d1(  9, 16) =    27.51    
           dB_d1(  9, 17) =   -3.543    
           dB_d1(  9, 18) =    18.07    
           dB_d1(  9, 19) =   -3.965    
           dB_d1(  9, 20) =    10.35    
           dB_d1(  9, 21) =   -3.080    
           dB_d1(  9, 22) =    1.325    
           dB_d1(  9, 23) =   -4.457    
           dB_d1(  9, 24) =    11.06    
           dB_d1(  9, 25) =   -5.775    
           dB_d1(  9, 26) =    27.56    
           dB_d1(  9, 27) =   0.1000E-01
           dB_d1(  9, 28) =    13.42    
           dB_d1( 10,  1) =    8.021    
           dB_d1( 10,  2) =   -24.76    
           dB_d1( 10,  3) =   -16.47    
           dB_d1( 10,  4) =    2.075    
           dB_d1( 10,  5) =   -7.275    
           dB_d1( 10,  6) =   -102.7    
           dB_d1( 10,  7) =   -8.234    
           dB_d1( 10,  8) =  -0.4970    
           dB_d1( 10,  9) =   -71.77    
           dB_d1( 10, 10) =   -42.06    
           dB_d1( 10, 11) =    14.85    
           dB_d1( 10, 12) =    54.86    
           dB_d1( 10, 13) =   -8.579    
           dB_d1( 10, 14) =   -16.74    
           dB_d1( 10, 15) =   -1.465    
           dB_d1( 10, 16) =    31.60    
           dB_d1( 10, 17) =   -7.138    
           dB_d1( 10, 18) =    24.54    
           dB_d1( 10, 19) =   -5.987    
           dB_d1( 10, 20) =    12.87    
           dB_d1( 10, 21) =   -6.775    
           dB_d1( 10, 22) =    10.20    
           dB_d1( 10, 23) =    1.045    
           dB_d1( 10, 24) =    24.54    
           dB_d1( 10, 25) =   -7.350    
           dB_d1( 10, 26) =    40.35    
           dB_d1( 10, 27) =   -3.157    
           dB_d1( 10, 28) =    14.54    
           dB_d1( 11,  1) =  -0.9295    
           dB_d1( 11,  2) =   -24.86    
           dB_d1( 11,  3) =   -18.19    
           dB_d1( 11,  4) =    36.06    
           dB_d1( 11,  5) =   -20.57    
           dB_d1( 11,  6) =   -117.9    
           dB_d1( 11,  7) =   -5.457    
           dB_d1( 11,  8) =    22.11    
           dB_d1( 11,  9) =   -111.3    
           dB_d1( 11, 10) =   -56.87    
           dB_d1( 11, 11) =    10.36    
           dB_d1( 11, 12) =    59.09    
           dB_d1( 11, 13) =   -2.793    
           dB_d1( 11, 14) =    3.765    
           dB_d1( 11, 15) =  -0.3500    
           dB_d1( 11, 16) =    14.85    
           dB_d1( 11, 17) =   -7.918    
           dB_d1( 11, 18) =    6.420    
           dB_d1( 11, 19) =   -6.263    
           dB_d1( 11, 20) =    1.190    
           dB_d1( 11, 21) =   -4.265    
           dB_d1( 11, 22) =    24.81    
           dB_d1( 11, 23) =    4.487    
           dB_d1( 11, 24) =    27.75    
           dB_d1( 11, 25) =   -5.815    
           dB_d1( 11, 26) =    24.41    
           dB_d1( 11, 27) =   -2.053    
           dB_d1( 11, 28) =    22.89    
           dB_d1( 12,  1) =   -7.513    
           dB_d1( 12,  2) =   -11.22    
           dB_d1( 12,  3) =   -12.84    
           dB_d1( 12,  4) =    46.57    
           dB_d1( 12,  5) =   -21.01    
           dB_d1( 12,  6) =   -90.65    
           dB_d1( 12,  7) =   -1.025    
           dB_d1( 12,  8) =    45.78    
           dB_d1( 12,  9) =   -119.8    
           dB_d1( 12, 10) =   -45.59    
           dB_d1( 12, 11) =    16.53    
           dB_d1( 12, 12) =    63.94    
           dB_d1( 12, 13) =    3.937    
           dB_d1( 12, 14) =    20.35    
           dB_d1( 12, 15) =   0.5550    
           dB_d1( 12, 16) =    5.685    
           dB_d1( 12, 17) =    5.380    
           dB_d1( 12, 18) =    13.97    
           dB_d1( 12, 19) =    2.899    
           dB_d1( 12, 20) =   -10.44    
           dB_d1( 12, 21) =   -1.450    
           dB_d1( 12, 22) =    24.16    
           dB_d1( 12, 23) =    8.507    
           dB_d1( 12, 24) =    11.24    
           dB_d1( 12, 25) =    5.140    
           dB_d1( 12, 26) =    36.98    
           dB_d1( 12, 27) =  -0.3885    
           dB_d1( 12, 28) =    24.27    
           dB_d1( 13,  1) =   -13.64    
           dB_d1( 13,  2) =    9.155    
           dB_d1( 13,  3) =    9.473    
           dB_d1( 13,  4) =    43.28    
           dB_d1( 13,  5) =   -5.840    
           dB_d1( 13,  6) =   -31.93    
           dB_d1( 13,  7) =    4.388    
           dB_d1( 13,  8) =    43.10    
           dB_d1( 13,  9) =   -69.93    
           dB_d1( 13, 10) =   -3.231    
           dB_d1( 13, 11) =    14.42    
           dB_d1( 13, 12) =    48.41    
           dB_d1( 13, 13) =    15.06    
           dB_d1( 13, 14) =    31.73    
           dB_d1( 13, 15) =   -3.437    
           dB_d1( 13, 16) =   -3.190    
           dB_d1( 13, 17) =    19.33    
           dB_d1( 13, 18) =    7.445    
           dB_d1( 13, 19) =    6.158    
           dB_d1( 13, 20) =    4.695    
           dB_d1( 13, 21) =    5.130    
           dB_d1( 13, 22) =    35.68    
           dB_d1( 13, 23) =    8.318    
           dB_d1( 13, 24) =    7.820    
           dB_d1( 13, 25) =    6.030    
           dB_d1( 13, 26) =    34.78    
           dB_d1( 13, 27) =    4.433    
           dB_d1( 13, 28) =    26.20    
           dB_d1( 14,  1) =   -21.10    
           dB_d1( 14,  2) =    12.57    
           dB_d1( 14,  3) =    33.19    
           dB_d1( 14,  4) =    47.66    
           dB_d1( 14,  5) =    27.15    
           dB_d1( 14,  6) =    43.79    
           dB_d1( 14,  7) =    7.819    
           dB_d1( 14,  8) =    36.27    
           dB_d1( 14,  9) =    4.525    
           dB_d1( 14, 10) =    51.70    
           dB_d1( 14, 11) =   -8.098    
           dB_d1( 14, 12) =   -30.57    
           dB_d1( 14, 13) =    14.87    
           dB_d1( 14, 14) =    15.84    
           dB_d1( 14, 15) =  -0.4650    
           dB_d1( 14, 16) =   -10.59    
           dB_d1( 14, 17) =    18.72    
           dB_d1( 14, 18) =   0.6350    
           dB_d1( 14, 19) =    13.03    
           dB_d1( 14, 20) =    51.12    
           dB_d1( 14, 21) =   -1.510    
           dB_d1( 14, 22) =    8.075    
           dB_d1( 14, 23) =    7.363    
           dB_d1( 14, 24) =  -0.8800    
           dB_d1( 14, 25) =  -0.1350    
           dB_d1( 14, 26) =    11.41    
           dB_d1( 14, 27) =    2.485    
           dB_d1( 14, 28) =    35.17    
           dB_d1( 15,  1) =   -33.63    
           dB_d1( 15,  2) =    1.578    
           dB_d1( 15,  3) =    48.46    
           dB_d1( 15,  4) =    93.52    
           dB_d1( 15,  5) =    54.82    
           dB_d1( 15,  6) =    75.00    
           dB_d1( 15,  7) =   -17.99    
           dB_d1( 15,  8) =   -47.22    
           dB_d1( 15,  9) =    26.41    
           dB_d1( 15, 10) =    17.72    
           dB_d1( 15, 11) =   -24.21    
           dB_d1( 15, 12) =   -56.95    
           dB_d1( 15, 13) =    11.35    
           dB_d1( 15, 14) =    10.50    
           dB_d1( 15, 15) =    5.120    
           dB_d1( 15, 16) =    3.700    
           dB_d1( 15, 17) =    15.82    
           dB_d1( 15, 18) =   0.5650    
           dB_d1( 15, 19) =    15.22    
           dB_d1( 15, 20) =    19.30    
           dB_d1( 15, 21) =   -9.710    
           dB_d1( 15, 22) =    8.370    
           dB_d1( 15, 23) =    3.720    
           dB_d1( 15, 24) =   -9.740    
           dB_d1( 15, 25) =    1.977    
           dB_d1( 15, 26) =   -3.755    
           dB_d1( 15, 27) =    2.930    
           dB_d1( 15, 28) =   -1.474    
           dB_d1( 16,  1) =   -15.07    
           dB_d1( 16,  2) =    45.74    
           dB_d1( 16,  3) =    66.06    
           dB_d1( 16,  4) =    97.09    
           dB_d1( 16,  5) =    27.70    
           dB_d1( 16,  6) =    22.82    
           dB_d1( 16,  7) =   -23.90    
           dB_d1( 16,  8) =   -35.31    
           dB_d1( 16,  9) =    25.09    
           dB_d1( 16, 10) =   -24.50    
           dB_d1( 16, 11) =   -10.78    
           dB_d1( 16, 12) =   -59.44    
           dB_d1( 16, 13) =    22.00    
           dB_d1( 16, 14) =    40.71    
           dB_d1( 16, 15) =    5.785    
           dB_d1( 16, 16) =    16.41    
           dB_d1( 16, 17) =    3.753    
           dB_d1( 16, 18) =   -2.340    
           dB_d1( 16, 19) =    8.281    
           dB_d1( 16, 20) =    24.11    
           dB_d1( 16, 21) =   -15.35    
           dB_d1( 16, 22) =   -10.96    
           dB_d1( 16, 23) =    1.485    
           dB_d1( 16, 24) =   -55.13    
           dB_d1( 16, 25) =    5.997    
           dB_d1( 16, 26) =   -9.875    
           dB_d1( 16, 27) =    8.288    
           dB_d1( 16, 28) =    1.100    
           dB_d1( 17,  1) =   -9.200    
           dB_d1( 17,  2) =    60.09    
           dB_d1( 17,  3) =    75.78    
           dB_d1( 17,  4) =    127.9    
           dB_d1( 17,  5) =   -1.004    
           dB_d1( 17,  6) =    7.470    
           dB_d1( 17,  7) =   -58.12    
           dB_d1( 17,  8) =   -77.57    
           dB_d1( 17,  9) =    25.29    
           dB_d1( 17, 10) =   -18.53    
           dB_d1( 17, 11) =   -11.12    
           dB_d1( 17, 12) =   -70.92    
           dB_d1( 17, 13) =    20.86    
           dB_d1( 17, 14) =    31.62    
           dB_d1( 17, 15) =    18.41    
           dB_d1( 17, 16) =    23.20    
           dB_d1( 17, 17) =   -6.509    
           dB_d1( 17, 18) =   -30.22    
           dB_d1( 17, 19) =    9.063    
           dB_d1( 17, 20) =    4.795    
           dB_d1( 17, 21) =   -4.975    
           dB_d1( 17, 22) =   -2.550    
           dB_d1( 17, 23) =   -8.560    
           dB_d1( 17, 24) =   -61.61    
           dB_d1( 17, 25) =    17.52    
           dB_d1( 17, 26) =    15.24    
           dB_d1( 17, 27) =    7.171    
           dB_d1( 17, 28) =    5.515    
           dB_d1( 18,  1) =    2.115    
           dB_d1( 18,  2) =    83.69    
           dB_d1( 18,  3) =    69.46    
           dB_d1( 18,  4) =    118.0    
           dB_d1( 18,  5) =   -23.05    
           dB_d1( 18,  6) =   0.6475    
           dB_d1( 18,  7) =   -52.40    
           dB_d1( 18,  8) =   -85.33    
           dB_d1( 18,  9) =    10.58    
           dB_d1( 18, 10) =    9.990    
           dB_d1( 18, 11) =   -7.286    
           dB_d1( 18, 12) =   -74.87    
           dB_d1( 18, 13) =    19.63    
           dB_d1( 18, 14) =    33.11    
           dB_d1( 18, 15) =    19.75    
           dB_d1( 18, 16) =    26.14    
           dB_d1( 18, 17) =   -8.908    
           dB_d1( 18, 18) =   -33.51    
           dB_d1( 18, 19) =    4.560    
           dB_d1( 18, 20) =    26.60    
           dB_d1( 18, 21) =   -2.415    
           dB_d1( 18, 22) =    4.064    
           dB_d1( 18, 23) =   -8.125    
           dB_d1( 18, 24) =   -51.72    
           dB_d1( 18, 25) =    18.37    
           dB_d1( 18, 26) =    26.81    
           dB_d1( 18, 27) =    10.62    
           dB_d1( 18, 28) =    37.85    
           dB_d1( 19,  1) =   -8.122    
           dB_d1( 19,  2) =    87.47    
           dB_d1( 19,  3) =    52.62    
           dB_d1( 19,  4) =    81.47    
           dB_d1( 19,  5) =   -8.713    
           dB_d1( 19,  6) =    55.10    
           dB_d1( 19,  7) =   -15.50    
           dB_d1( 19,  8) =   -44.94    
           dB_d1( 19,  9) =    22.18    
           dB_d1( 19, 10) =    75.53    
           dB_d1( 19, 11) =    3.801    
           dB_d1( 19, 12) =   -42.33    
           dB_d1( 19, 13) =    9.299    
           dB_d1( 19, 14) =    30.23    
           dB_d1( 19, 15) =    7.900    
           dB_d1( 19, 16) =    7.450    
           dB_d1( 19, 17) =   -18.49    
           dB_d1( 19, 18) =   -67.88    
           dB_d1( 19, 19) =    9.252    
           dB_d1( 19, 20) =    37.67    
           dB_d1( 19, 21) =    9.197    
           dB_d1( 19, 22) =    13.22    
           dB_d1( 19, 23) =   -2.990    
           dB_d1( 19, 24) =   -27.95    
           dB_d1( 19, 25) =    16.39    
           dB_d1( 19, 26) =    31.08    
           dB_d1( 19, 27) =    1.207    
           dB_d1( 19, 28) =    26.73    
           dB_d1( 20,  1) =  -0.4423E-01
           dB_d1( 20,  2) =    45.75    
           dB_d1( 20,  3) =    43.37    
           dB_d1( 20,  4) =    42.25    
           dB_d1( 20,  5) =    6.343    
           dB_d1( 20,  6) =    32.88    
           dB_d1( 20,  7) =    5.220    
           dB_d1( 20,  8) =   -13.46    
           dB_d1( 20,  9) =    46.99    
           dB_d1( 20, 10) =    27.44    
           dB_d1( 20, 11) =   -27.16    
           dB_d1( 20, 12) =   -128.2    
           dB_d1( 20, 13) =   0.4045E-01
           dB_d1( 20, 14) =    8.165    
           dB_d1( 20, 15) =   -24.31    
           dB_d1( 20, 16) =    29.07    
           dB_d1( 20, 17) =   -22.28    
           dB_d1( 20, 18) =   -74.92    
           dB_d1( 20, 19) =   -9.941    
           dB_d1( 20, 20) =    21.23    
           dB_d1( 20, 21) =    10.05    
           dB_d1( 20, 22) =    5.220    
           dB_d1( 20, 23) =  -0.7900    
           dB_d1( 20, 24) =    18.61    
           dB_d1( 20, 25) =    25.09    
           dB_d1( 20, 26) =    40.47    
           dB_d1( 20, 27) =    16.63    
           dB_d1( 20, 28) =    79.55    
           dB_d1( 21,  1) =   -11.35    
           dB_d1( 21,  2) =   -37.62    
           dB_d1( 21,  3) =    10.51    
           dB_d1( 21,  4) =   -38.21    
           dB_d1( 21,  5) =    9.111    
           dB_d1( 21,  6) =    3.039    
           dB_d1( 21,  7) =    34.13    
           dB_d1( 21,  8) =    144.4    
           dB_d1( 21,  9) =    55.79    
           dB_d1( 21, 10) =    63.00    
           dB_d1( 21, 11) =    5.224    
           dB_d1( 21, 12) =   -217.9    
           dB_d1( 21, 13) =   0.7350    
           dB_d1( 21, 14) =   -43.32    
           dB_d1( 21, 15) =   -12.08    
           dB_d1( 21, 16) =   -5.470    
           dB_d1( 21, 17) =   -26.88    
           dB_d1( 21, 18) =   -56.19    
           dB_d1( 21, 19) =   -5.804    
           dB_d1( 21, 20) =    58.84    
           dB_d1( 21, 21) =    1.800    
           dB_d1( 21, 22) =    3.428    
           dB_d1( 21, 23) =  -0.5450    
           dB_d1( 21, 24) =   -7.641    
           dB_d1( 21, 25) =    13.85    
           dB_d1( 21, 26) =    7.073    
           dB_d1( 21, 27) =    17.10    
           dB_d1( 21, 28) =    10.20    
           dB_d1( 22,  1) =   -11.35    
           dB_d1( 22,  2) =   -34.89    
           dB_d1( 22,  3) =   -7.447    
           dB_d1( 22,  4) =   -22.10    
           dB_d1( 22,  5) =    20.01    
           dB_d1( 22,  6) =    43.34    
           dB_d1( 22,  7) =    88.11    
           dB_d1( 22,  8) =    153.3    
           dB_d1( 22,  9) =    76.78    
           dB_d1( 22, 10) =    109.3    
           dB_d1( 22, 11) =   -2.811    
           dB_d1( 22, 12) =   -113.7    
           dB_d1( 22, 13) =    10.15    
           dB_d1( 22, 14) =   -48.60    
           dB_d1( 22, 15) =    5.734    
           dB_d1( 22, 16) =    3.320    
           dB_d1( 22, 17) =   -22.24    
           dB_d1( 22, 18) =   -14.64    
           dB_d1( 22, 19) =   -9.377    
           dB_d1( 22, 20) =    101.3    
           dB_d1( 22, 21) =    7.858    
           dB_d1( 22, 22) =   -13.18    
           dB_d1( 22, 23) =   -5.570    
           dB_d1( 22, 24) =   -52.72    
           dB_d1( 22, 25) =   -1.903    
           dB_d1( 22, 26) =    2.935    
           dB_d1( 22, 27) =    9.115    
           dB_d1( 22, 28) =    2.703    
           dB_d1( 23,  1) =   -30.16    
           dB_d1( 23,  2) =    17.90    
           dB_d1( 23,  3) =    12.48    
           dB_d1( 23,  4) =    45.25    
           dB_d1( 23,  5) =    23.53    
           dB_d1( 23,  6) =    46.71    
           dB_d1( 23,  7) =    48.33    
           dB_d1( 23,  8) =    192.6    
           dB_d1( 23,  9) =    112.9    
           dB_d1( 23, 10) =    40.50    
           dB_d1( 23, 11) =   -4.173    
           dB_d1( 23, 12) =   -249.3    
           dB_d1( 23, 13) =    1.715    
           dB_d1( 23, 14) =   -16.59    
           dB_d1( 23, 15) =    2.245    
           dB_d1( 23, 16) =   -39.28    
           dB_d1( 23, 17) =   -4.545    
           dB_d1( 23, 18) =   -55.15    
           dB_d1( 23, 19) =    3.859    
           dB_d1( 23, 20) =    146.4    
           dB_d1( 23, 21) =   -13.08    
           dB_d1( 23, 22) =   -26.31    
           dB_d1( 23, 23) =   -9.983    
           dB_d1( 23, 24) =    25.27    
           dB_d1( 23, 25) =    17.38    
           dB_d1( 23, 26) =   -50.31    
           dB_d1( 23, 27) =    10.97    
           dB_d1( 23, 28) =    6.755    
       
           ! Fill dB_d2 arrays:
           dB_d2(  1,  1) =   0.7135    
           dB_d2(  1,  2) =    1.809    
           dB_d2(  1,  3) =   0.3687    
           dB_d2(  1,  4) =   0.1490    
           dB_d2(  1,  5) =    2.356    
           dB_d2(  1,  6) =    5.826    
           dB_d2(  1,  7) =  -0.6318    
           dB_d2(  1,  8) =   -4.516    
           dB_d2(  1,  9) =    1.682    
           dB_d2(  1, 10) =    1.021    
           dB_d2(  1, 11) =  -0.3735    
           dB_d2(  1, 12) =   -4.118    
           dB_d2(  1, 13) =  -0.1732    
           dB_d2(  1, 14) =   -1.799    
           dB_d2(  1, 15) =   0.6663    
           dB_d2(  1, 16) =   -1.226    
           dB_d2(  1, 17) =  -0.3508    
           dB_d2(  1, 18) =   -1.921    
           dB_d2(  1, 19) =   0.3507    
           dB_d2(  1, 20) =   -1.524    
           dB_d2(  1, 21) =  -0.6800E-01
           dB_d2(  1, 22) =  -0.8650E-01
           dB_d2(  1, 23) =    1.462    
           dB_d2(  1, 24) =   -2.140    
           dB_d2(  1, 25) =  -0.3400E-01
           dB_d2(  1, 26) =   -2.945    
           dB_d2(  1, 27) =   0.5105    
           dB_d2(  1, 28) =    2.901    
           dB_d2(  2,  1) =    2.019    
           dB_d2(  2,  2) =    9.976    
           dB_d2(  2,  3) =    1.129    
           dB_d2(  2,  4) =    2.960    
           dB_d2(  2,  5) =    2.265    
           dB_d2(  2,  6) =   -3.824    
           dB_d2(  2,  7) =   0.2277    
           dB_d2(  2,  8) =    1.101    
           dB_d2(  2,  9) =  -0.2554    
           dB_d2(  2, 10) =   -3.601    
           dB_d2(  2, 11) =   0.4680E-01
           dB_d2(  2, 12) =    1.241    
           dB_d2(  2, 13) =   0.3695    
           dB_d2(  2, 14) =  -0.8540    
           dB_d2(  2, 15) =   0.4909    
           dB_d2(  2, 16) =   -3.372    
           dB_d2(  2, 17) =   0.1125    
           dB_d2(  2, 18) =   -2.433    
           dB_d2(  2, 19) =   0.8381    
           dB_d2(  2, 20) =    2.261    
           dB_d2(  2, 21) =  -0.1765    
           dB_d2(  2, 22) =   -3.020    
           dB_d2(  2, 23) =   0.9657    
           dB_d2(  2, 24) =  -0.1368    
           dB_d2(  2, 25) =  -0.8726    
           dB_d2(  2, 26) =   -5.983    
           dB_d2(  2, 27) =   0.6850E-01
           dB_d2(  2, 28) =    6.257    
           dB_d2(  3,  1) =    1.987    
           dB_d2(  3,  2) =    18.35    
           dB_d2(  3,  3) =    1.668    
           dB_d2(  3,  4) =    5.029    
           dB_d2(  3,  5) =   0.4844    
           dB_d2(  3,  6) =    3.417    
           dB_d2(  3,  7) =   -1.371    
           dB_d2(  3,  8) =  -0.9335    
           dB_d2(  3,  9) =   -2.750    
           dB_d2(  3, 10) =   -4.560    
           dB_d2(  3, 11) =   -2.423    
           dB_d2(  3, 12) =    1.074    
           dB_d2(  3, 13) =  -0.5970    
           dB_d2(  3, 14) =    3.745    
           dB_d2(  3, 15) =    1.243    
           dB_d2(  3, 16) =   -3.244    
           dB_d2(  3, 17) =  -0.3140    
           dB_d2(  3, 18) =   -8.730    
           dB_d2(  3, 19) =   0.8508    
           dB_d2(  3, 20) =    1.830    
           dB_d2(  3, 21) =   0.3934    
           dB_d2(  3, 22) =   -6.437    
           dB_d2(  3, 23) =   0.3200    
           dB_d2(  3, 24) =   -3.910    
           dB_d2(  3, 25) =  -0.3380    
           dB_d2(  3, 26) =   -10.47    
           dB_d2(  3, 27) =   0.8140    
           dB_d2(  3, 28) =    7.772    
           dB_d2(  4,  1) =    2.859    
           dB_d2(  4,  2) =    20.27    
           dB_d2(  4,  3) =   0.8659    
           dB_d2(  4,  4) =    11.15    
           dB_d2(  4,  5) =  -0.5360    
           dB_d2(  4,  6) =   -1.835    
           dB_d2(  4,  7) =   0.1795    
           dB_d2(  4,  8) =    4.821    
           dB_d2(  4,  9) =   -6.722    
           dB_d2(  4, 10) =   -1.347    
           dB_d2(  4, 11) =  -0.2792    
           dB_d2(  4, 12) =    4.463    
           dB_d2(  4, 13) =   -2.229    
           dB_d2(  4, 14) =    1.545    
           dB_d2(  4, 15) =   0.9031    
           dB_d2(  4, 16) =   -3.755    
           dB_d2(  4, 17) =   0.4805    
           dB_d2(  4, 18) =   -11.38    
           dB_d2(  4, 19) =  -0.2236    
           dB_d2(  4, 20) =    2.857    
           dB_d2(  4, 21) =  -0.6500    
           dB_d2(  4, 22) =   -7.796    
           dB_d2(  4, 23) =  -0.3295    
           dB_d2(  4, 24) =   -4.219    
           dB_d2(  4, 25) =   0.8920    
           dB_d2(  4, 26) =   -11.23    
           dB_d2(  4, 27) =    1.451    
           dB_d2(  4, 28) =    9.145    
           dB_d2(  5,  1) =    4.339    
           dB_d2(  5,  2) =    24.38    
           dB_d2(  5,  3) =    2.230    
           dB_d2(  5,  4) =    11.22    
           dB_d2(  5,  5) =   -1.033    
           dB_d2(  5,  6) =   -3.770    
           dB_d2(  5,  7) =    3.500    
           dB_d2(  5,  8) =    2.262    
           dB_d2(  5,  9) =   -7.733    
           dB_d2(  5, 10) =  -0.8400E-01
           dB_d2(  5, 11) =    3.691    
           dB_d2(  5, 12) =    10.12    
           dB_d2(  5, 13) =   -3.446    
           dB_d2(  5, 14) =   -1.625    
           dB_d2(  5, 15) =   0.1155    
           dB_d2(  5, 16) =   -10.12    
           dB_d2(  5, 17) =   0.6495    
           dB_d2(  5, 18) =   -11.13    
           dB_d2(  5, 19) =   0.3300    
           dB_d2(  5, 20) =    8.434    
           dB_d2(  5, 21) =   -1.970    
           dB_d2(  5, 22) =   -5.180    
           dB_d2(  5, 23) =   -1.938    
           dB_d2(  5, 24) =   -2.970    
           dB_d2(  5, 25) =    1.087    
           dB_d2(  5, 26) =   -8.411    
           dB_d2(  5, 27) =    2.609    
           dB_d2(  5, 28) =    8.038    
           dB_d2(  6,  1) =    3.386    
           dB_d2(  6,  2) =    37.72    
           dB_d2(  6,  3) =    3.633    
           dB_d2(  6,  4) =    19.01    
           dB_d2(  6,  5) =   -1.729    
           dB_d2(  6,  6) =   0.5550    
           dB_d2(  6,  7) =    3.694    
           dB_d2(  6,  8) =   -2.051    
           dB_d2(  6,  9) =   -8.964    
           dB_d2(  6, 10) =   0.8400E-01
           dB_d2(  6, 11) =    7.449    
           dB_d2(  6, 12) =    9.863    
           dB_d2(  6, 13) =   -2.677    
           dB_d2(  6, 14) =   -2.210    
           dB_d2(  6, 15) =   0.1520    
           dB_d2(  6, 16) =   -9.876    
           dB_d2(  6, 17) =  -0.1045    
           dB_d2(  6, 18) =   -11.62    
           dB_d2(  6, 19) =    2.114    
           dB_d2(  6, 20) =    14.10    
           dB_d2(  6, 21) =   -1.037    
           dB_d2(  6, 22) =   -6.625    
           dB_d2(  6, 23) =   -2.942    
           dB_d2(  6, 24) =  -0.7915    
           dB_d2(  6, 25) =   0.5235    
           dB_d2(  6, 26) =   -7.595    
           dB_d2(  6, 27) =    3.141    
           dB_d2(  6, 28) =    7.064    
           dB_d2(  7,  1) =    4.668    
           dB_d2(  7,  2) =    51.13    
           dB_d2(  7,  3) =    2.400    
           dB_d2(  7,  4) =    21.36    
           dB_d2(  7,  5) =   -5.812    
           dB_d2(  7,  6) =   -11.90    
           dB_d2(  7,  7) =    1.849    
           dB_d2(  7,  8) =    8.105    
           dB_d2(  7,  9) =   -15.98    
           dB_d2(  7, 10) =   -6.849    
           dB_d2(  7, 11) =    7.428    
           dB_d2(  7, 12) =    21.44    
           dB_d2(  7, 13) =  -0.6810    
           dB_d2(  7, 14) =   -2.875    
           dB_d2(  7, 15) =    1.570    
           dB_d2(  7, 16) =   -6.075    
           dB_d2(  7, 17) =   -3.551    
           dB_d2(  7, 18) =   -14.24    
           dB_d2(  7, 19) =   0.9703    
           dB_d2(  7, 20) =    17.18    
           dB_d2(  7, 21) =    2.583    
           dB_d2(  7, 22) =   0.5650    
           dB_d2(  7, 23) =   -1.085    
           dB_d2(  7, 24) =   -5.584    
           dB_d2(  7, 25) =   0.8750    
           dB_d2(  7, 26) =   -3.955    
           dB_d2(  7, 27) =    2.114    
           dB_d2(  7, 28) =  -0.5450    
           dB_d2(  8,  1) =    5.495    
           dB_d2(  8,  2) =    53.58    
           dB_d2(  8,  3) =    1.273    
           dB_d2(  8,  4) =    26.20    
           dB_d2(  8,  5) =   -11.52    
           dB_d2(  8,  6) =   -31.86    
           dB_d2(  8,  7) =   -1.088    
           dB_d2(  8,  8) =    17.24    
           dB_d2(  8,  9) =   -25.55    
           dB_d2(  8, 10) =   -18.13    
           dB_d2(  8, 11) =    8.221    
           dB_d2(  8, 12) =    20.68    
           dB_d2(  8, 13) =    2.133    
           dB_d2(  8, 14) =   -8.325    
           dB_d2(  8, 15) =    3.227    
           dB_d2(  8, 16) =   -6.650    
           dB_d2(  8, 17) =   -5.766    
           dB_d2(  8, 18) =   -19.77    
           dB_d2(  8, 19) =   0.9880    
           dB_d2(  8, 20) =    26.31    
           dB_d2(  8, 21) =    2.454    
           dB_d2(  8, 22) =   -18.23    
           dB_d2(  8, 23) =    1.415    
           dB_d2(  8, 24) =   -5.055    
           dB_d2(  8, 25) =  -0.8950    
           dB_d2(  8, 26) =   -5.230    
           dB_d2(  8, 27) =   -1.561    
           dB_d2(  8, 28) =    5.015    
           dB_d2(  9,  1) =    5.681    
           dB_d2(  9,  2) =    47.25    
           dB_d2(  9,  3) =    4.969    
           dB_d2(  9,  4) =    24.74    
           dB_d2(  9,  5) =   -16.45    
           dB_d2(  9,  6) =   -45.38    
           dB_d2(  9,  7) =   -2.979    
           dB_d2(  9,  8) =    9.075    
           dB_d2(  9,  9) =   -35.03    
           dB_d2(  9, 10) =   -22.53    
           dB_d2(  9, 11) =    6.080    
           dB_d2(  9, 12) =    28.50    
           dB_d2(  9, 13) =    3.543    
           dB_d2(  9, 14) =   -18.07    
           dB_d2(  9, 15) =    3.965    
           dB_d2(  9, 16) =   -10.35    
           dB_d2(  9, 17) =   -6.755    
           dB_d2(  9, 18) =   -21.69    
           dB_d2(  9, 19) =   -1.603    
           dB_d2(  9, 20) =    27.51    
           dB_d2(  9, 21) =    5.775    
           dB_d2(  9, 22) =   -27.56    
           dB_d2(  9, 23) =  -0.1000E-01
           dB_d2(  9, 24) =   -13.42    
           dB_d2(  9, 25) =   -3.080    
           dB_d2(  9, 26) =    1.325    
           dB_d2(  9, 27) =   -4.457    
           dB_d2(  9, 28) =    11.06    
           dB_d2( 10,  1) =    3.232    
           dB_d2( 10,  2) =    37.70    
           dB_d2( 10,  3) =    4.673    
           dB_d2( 10,  4) =    20.25    
           dB_d2( 10,  5) =   -27.17    
           dB_d2( 10,  6) =   -78.06    
           dB_d2( 10,  7) =   -4.326    
           dB_d2( 10,  8) =    11.06    
           dB_d2( 10,  9) =   -49.20    
           dB_d2( 10, 10) =   -27.52    
           dB_d2( 10, 11) =    8.791    
           dB_d2( 10, 12) =    30.46    
           dB_d2( 10, 13) =    7.138    
           dB_d2( 10, 14) =   -24.54    
           dB_d2( 10, 15) =    5.987    
           dB_d2( 10, 16) =   -12.87    
           dB_d2( 10, 17) =   -8.579    
           dB_d2( 10, 18) =   -16.74    
           dB_d2( 10, 19) =   -1.465    
           dB_d2( 10, 20) =    31.60    
           dB_d2( 10, 21) =    7.350    
           dB_d2( 10, 22) =   -40.35    
           dB_d2( 10, 23) =    3.157    
           dB_d2( 10, 24) =   -14.54    
           dB_d2( 10, 25) =   -6.775    
           dB_d2( 10, 26) =    10.20    
           dB_d2( 10, 27) =    1.045    
           dB_d2( 10, 28) =    24.54    
           dB_d2( 11,  1) =   -1.685    
           dB_d2( 11,  2) =    38.74    
           dB_d2( 11,  3) =    6.187    
           dB_d2( 11,  4) =    37.48    
           dB_d2( 11,  5) =   -39.95    
           dB_d2( 11,  6) =   -69.23    
           dB_d2( 11,  7) =   -5.340    
           dB_d2( 11,  8) =    8.670    
           dB_d2( 11,  9) =   -66.93    
           dB_d2( 11, 10) =   -46.61    
           dB_d2( 11, 11) =    9.850    
           dB_d2( 11, 12) =    32.53    
           dB_d2( 11, 13) =    7.918    
           dB_d2( 11, 14) =   -6.420    
           dB_d2( 11, 15) =    6.263    
           dB_d2( 11, 16) =   -1.190    
           dB_d2( 11, 17) =   -2.793    
           dB_d2( 11, 18) =    3.765    
           dB_d2( 11, 19) =  -0.3500    
           dB_d2( 11, 20) =    14.85    
           dB_d2( 11, 21) =    5.815    
           dB_d2( 11, 22) =   -24.41    
           dB_d2( 11, 23) =    2.053    
           dB_d2( 11, 24) =   -22.89    
           dB_d2( 11, 25) =   -4.265    
           dB_d2( 11, 26) =    24.81    
           dB_d2( 11, 27) =    4.487    
           dB_d2( 11, 28) =    27.75    
           dB_d2( 12,  1) =   -3.380    
           dB_d2( 12,  2) =    38.54    
           dB_d2( 12,  3) =    8.460    
           dB_d2( 12,  4) =    47.90    
           dB_d2( 12,  5) =   -46.84    
           dB_d2( 12,  6) =   -68.11    
           dB_d2( 12,  7) =   -3.029    
           dB_d2( 12,  8) =    40.42    
           dB_d2( 12,  9) =   -64.21    
           dB_d2( 12, 10) =   -57.03    
           dB_d2( 12, 11) =    9.521    
           dB_d2( 12, 12) =    16.52    
           dB_d2( 12, 13) =   -5.380    
           dB_d2( 12, 14) =   -13.97    
           dB_d2( 12, 15) =   -2.899    
           dB_d2( 12, 16) =    10.44    
           dB_d2( 12, 17) =    3.937    
           dB_d2( 12, 18) =    20.35    
           dB_d2( 12, 19) =   0.5550    
           dB_d2( 12, 20) =    5.685    
           dB_d2( 12, 21) =   -5.140    
           dB_d2( 12, 22) =   -36.98    
           dB_d2( 12, 23) =   0.3885    
           dB_d2( 12, 24) =   -24.27    
           dB_d2( 12, 25) =   -1.450    
           dB_d2( 12, 26) =    24.16    
           dB_d2( 12, 27) =    8.507    
           dB_d2( 12, 28) =    11.24    
           dB_d2( 13,  1) =    2.440    
           dB_d2( 13,  2) =    44.11    
           dB_d2( 13,  3) =    6.652    
           dB_d2( 13,  4) =    30.35    
           dB_d2( 13,  5) =   -47.71    
           dB_d2( 13,  6) =   -64.97    
           dB_d2( 13,  7) =   -2.168    
           dB_d2( 13,  8) =    63.43    
           dB_d2( 13,  9) =   -50.28    
           dB_d2( 13, 10) =   -42.13    
           dB_d2( 13, 11) =    3.743    
           dB_d2( 13, 12) =   -2.680    
           dB_d2( 13, 13) =   -19.33    
           dB_d2( 13, 14) =   -7.445    
           dB_d2( 13, 15) =   -6.158    
           dB_d2( 13, 16) =   -4.695    
           dB_d2( 13, 17) =    15.06    
           dB_d2( 13, 18) =    31.73    
           dB_d2( 13, 19) =   -3.437    
           dB_d2( 13, 20) =   -3.190    
           dB_d2( 13, 21) =   -6.030    
           dB_d2( 13, 22) =   -34.78    
           dB_d2( 13, 23) =   -4.433    
           dB_d2( 13, 24) =   -26.20    
           dB_d2( 13, 25) =    5.130    
           dB_d2( 13, 26) =    35.68    
           dB_d2( 13, 27) =    8.318    
           dB_d2( 13, 28) =    7.820    
           dB_d2( 14,  1) =    8.901    
           dB_d2( 14,  2) =    35.39    
           dB_d2( 14,  3) =    14.79    
           dB_d2( 14,  4) =    27.47    
           dB_d2( 14,  5) =   -49.61    
           dB_d2( 14,  6) =   -51.62    
           dB_d2( 14,  7) =   -8.473    
           dB_d2( 14,  8) =    79.31    
           dB_d2( 14,  9) =   -37.47    
           dB_d2( 14, 10) =   -46.88    
           dB_d2( 14, 11) =    9.323    
           dB_d2( 14, 12) =   -20.99    
           dB_d2( 14, 13) =   -18.72    
           dB_d2( 14, 14) =  -0.6350    
           dB_d2( 14, 15) =   -13.03    
           dB_d2( 14, 16) =   -51.12    
           dB_d2( 14, 17) =    14.87    
           dB_d2( 14, 18) =    15.84    
           dB_d2( 14, 19) =  -0.4650    
           dB_d2( 14, 20) =   -10.59    
           dB_d2( 14, 21) =   0.1350    
           dB_d2( 14, 22) =   -11.41    
           dB_d2( 14, 23) =   -2.485    
           dB_d2( 14, 24) =   -35.17    
           dB_d2( 14, 25) =   -1.510    
           dB_d2( 14, 26) =    8.075    
           dB_d2( 14, 27) =    7.363    
           dB_d2( 14, 28) =  -0.8800    
           dB_d2( 15,  1) =    5.085    
           dB_d2( 15,  2) =    16.58    
           dB_d2( 15,  3) =    17.31    
           dB_d2( 15,  4) =    34.45    
           dB_d2( 15,  5) =   -44.01    
           dB_d2( 15,  6) =   -59.92    
           dB_d2( 15,  7) =   -13.63    
           dB_d2( 15,  8) =    71.71    
           dB_d2( 15,  9) =   -20.20    
           dB_d2( 15, 10) =   -45.66    
           dB_d2( 15, 11) =    7.727    
           dB_d2( 15, 12) =   -3.800    
           dB_d2( 15, 13) =   -15.82    
           dB_d2( 15, 14) =  -0.5650    
           dB_d2( 15, 15) =   -15.22    
           dB_d2( 15, 16) =   -19.30    
           dB_d2( 15, 17) =    11.35    
           dB_d2( 15, 18) =    10.50    
           dB_d2( 15, 19) =    5.120    
           dB_d2( 15, 20) =    3.700    
           dB_d2( 15, 21) =   -1.977    
           dB_d2( 15, 22) =    3.755    
           dB_d2( 15, 23) =   -2.930    
           dB_d2( 15, 24) =    1.474    
           dB_d2( 15, 25) =   -9.710    
           dB_d2( 15, 26) =    8.370    
           dB_d2( 15, 27) =    3.720    
           dB_d2( 15, 28) =   -9.740    
           dB_d2( 16,  1) =    5.626    
           dB_d2( 16,  2) =    17.25    
           dB_d2( 16,  3) =    12.25    
           dB_d2( 16,  4) =    19.70    
           dB_d2( 16,  5) =   -39.81    
           dB_d2( 16,  6) =   -62.79    
           dB_d2( 16,  7) =   -14.23    
           dB_d2( 16,  8) =    76.58    
           dB_d2( 16,  9) =   -10.34    
           dB_d2( 16, 10) =   -37.81    
           dB_d2( 16, 11) =    16.98    
           dB_d2( 16, 12) =    9.065    
           dB_d2( 16, 13) =   -3.753    
           dB_d2( 16, 14) =    2.340    
           dB_d2( 16, 15) =   -8.281    
           dB_d2( 16, 16) =   -24.11    
           dB_d2( 16, 17) =    22.00    
           dB_d2( 16, 18) =    40.71    
           dB_d2( 16, 19) =    5.785    
           dB_d2( 16, 20) =    16.41    
           dB_d2( 16, 21) =   -5.997    
           dB_d2( 16, 22) =    9.875    
           dB_d2( 16, 23) =   -8.288    
           dB_d2( 16, 24) =   -1.100    
           dB_d2( 16, 25) =   -15.35    
           dB_d2( 16, 26) =   -10.96    
           dB_d2( 16, 27) =    1.485    
           dB_d2( 16, 28) =   -55.13    
           dB_d2( 17,  1) =    7.012    
           dB_d2( 17,  2) =    19.94    
           dB_d2( 17,  3) =    12.60    
           dB_d2( 17,  4) =    41.96    
           dB_d2( 17,  5) =   -39.53    
           dB_d2( 17,  6) =   -85.40    
           dB_d2( 17,  7) =   -20.02    
           dB_d2( 17,  8) =    59.26    
           dB_d2( 17,  9) =   -4.318    
           dB_d2( 17, 10) =   -31.87    
           dB_d2( 17, 11) =    19.38    
           dB_d2( 17, 12) =    29.21    
           dB_d2( 17, 13) =    6.509    
           dB_d2( 17, 14) =    30.22    
           dB_d2( 17, 15) =   -9.063    
           dB_d2( 17, 16) =   -4.795    
           dB_d2( 17, 17) =    20.86    
           dB_d2( 17, 18) =    31.62    
           dB_d2( 17, 19) =    18.41    
           dB_d2( 17, 20) =    23.20    
           dB_d2( 17, 21) =   -17.52    
           dB_d2( 17, 22) =   -15.24    
           dB_d2( 17, 23) =   -7.171    
           dB_d2( 17, 24) =   -5.515    
           dB_d2( 17, 25) =   -4.975    
           dB_d2( 17, 26) =   -2.550    
           dB_d2( 17, 27) =   -8.560    
           dB_d2( 17, 28) =   -61.61    
           dB_d2( 18,  1) =    4.512    
           dB_d2( 18,  2) =    8.490    
           dB_d2( 18,  3) =    13.62    
           dB_d2( 18,  4) =    50.96    
           dB_d2( 18,  5) =   -48.70    
           dB_d2( 18,  6) =   -110.1    
           dB_d2( 18,  7) =   -15.37    
           dB_d2( 18,  8) =    58.19    
           dB_d2( 18,  9) =    3.562    
           dB_d2( 18, 10) =   -19.98    
           dB_d2( 18, 11) =    36.63    
           dB_d2( 18, 12) =    64.22    
           dB_d2( 18, 13) =    8.908    
           dB_d2( 18, 14) =    33.51    
           dB_d2( 18, 15) =   -4.560    
           dB_d2( 18, 16) =   -26.60    
           dB_d2( 18, 17) =    19.63    
           dB_d2( 18, 18) =    33.11    
           dB_d2( 18, 19) =    19.75    
           dB_d2( 18, 20) =    26.14    
           dB_d2( 18, 21) =   -18.37    
           dB_d2( 18, 22) =   -26.81    
           dB_d2( 18, 23) =   -10.62    
           dB_d2( 18, 24) =   -37.85    
           dB_d2( 18, 25) =   -2.415    
           dB_d2( 18, 26) =    4.064    
           dB_d2( 18, 27) =   -8.125    
           dB_d2( 18, 28) =   -51.72    
           dB_d2( 19,  1) =    3.665    
           dB_d2( 19,  2) =  -0.4000E-01
           dB_d2( 19,  3) =   -1.698    
           dB_d2( 19,  4) =    29.56    
           dB_d2( 19,  5) =   -64.58    
           dB_d2( 19,  6) =   -106.2    
           dB_d2( 19,  7) =    2.897    
           dB_d2( 19,  8) =    58.04    
           dB_d2( 19,  9) =    9.533    
           dB_d2( 19, 10) =    11.10    
           dB_d2( 19, 11) =    36.86    
           dB_d2( 19, 12) =    86.88    
           dB_d2( 19, 13) =    18.49    
           dB_d2( 19, 14) =    67.88    
           dB_d2( 19, 15) =   -9.252    
           dB_d2( 19, 16) =   -37.67    
           dB_d2( 19, 17) =    9.299    
           dB_d2( 19, 18) =    30.23    
           dB_d2( 19, 19) =    7.900    
           dB_d2( 19, 20) =    7.450    
           dB_d2( 19, 21) =   -16.39    
           dB_d2( 19, 22) =   -31.08    
           dB_d2( 19, 23) =   -1.207    
           dB_d2( 19, 24) =   -26.73    
           dB_d2( 19, 25) =    9.197    
           dB_d2( 19, 26) =    13.22    
           dB_d2( 19, 27) =   -2.990    
           dB_d2( 19, 28) =   -27.95    
           dB_d2( 20,  1) =   -1.595    
           dB_d2( 20,  2) =    28.08    
           dB_d2( 20,  3) =    4.809    
           dB_d2( 20,  4) =    36.20    
           dB_d2( 20,  5) =   -63.49    
           dB_d2( 20,  6) =   -65.38    
           dB_d2( 20,  7) =    2.836    
           dB_d2( 20,  8) =    95.40    
           dB_d2( 20,  9) =    9.952    
           dB_d2( 20, 10) =    21.08    
           dB_d2( 20, 11) =    54.38    
           dB_d2( 20, 12) =    185.5    
           dB_d2( 20, 13) =    22.28    
           dB_d2( 20, 14) =    74.92    
           dB_d2( 20, 15) =    9.941    
           dB_d2( 20, 16) =   -21.23    
           dB_d2( 20, 17) =   0.4045E-01
           dB_d2( 20, 18) =    8.165    
           dB_d2( 20, 19) =   -24.31    
           dB_d2( 20, 20) =    29.07    
           dB_d2( 20, 21) =   -25.09    
           dB_d2( 20, 22) =   -40.47    
           dB_d2( 20, 23) =   -16.63    
           dB_d2( 20, 24) =   -79.55    
           dB_d2( 20, 25) =    10.05    
           dB_d2( 20, 26) =    5.220    
           dB_d2( 20, 27) =  -0.7900    
           dB_d2( 20, 28) =    18.61    
           dB_d2( 21,  1) =    3.155    
           dB_d2( 21,  2) =    12.47    
           dB_d2( 21,  3) =    6.976    
           dB_d2( 21,  4) =   -19.11    
           dB_d2( 21,  5) =   -73.15    
           dB_d2( 21,  6) =   -74.88    
           dB_d2( 21,  7) =   0.8560    
           dB_d2( 21,  8) =    87.74    
           dB_d2( 21,  9) =    16.49    
           dB_d2( 21, 10) =    22.00    
           dB_d2( 21, 11) =    73.74    
           dB_d2( 21, 12) =    160.6    
           dB_d2( 21, 13) =    26.88    
           dB_d2( 21, 14) =    56.19    
           dB_d2( 21, 15) =    5.804    
           dB_d2( 21, 16) =   -58.84    
           dB_d2( 21, 17) =   0.7350    
           dB_d2( 21, 18) =   -43.32    
           dB_d2( 21, 19) =   -12.08    
           dB_d2( 21, 20) =   -5.470    
           dB_d2( 21, 21) =   -13.85    
           dB_d2( 21, 22) =   -7.073    
           dB_d2( 21, 23) =   -17.10    
           dB_d2( 21, 24) =   -10.20    
           dB_d2( 21, 25) =    1.800    
           dB_d2( 21, 26) =    3.428    
           dB_d2( 21, 27) =  -0.5450    
           dB_d2( 21, 28) =   -7.641    
           dB_d2( 22,  1) =    2.240    
           dB_d2( 22,  2) =   -3.380    
           dB_d2( 22,  3) =   -4.434    
           dB_d2( 22,  4) =   -28.59    
           dB_d2( 22,  5) =   -85.10    
           dB_d2( 22,  6) =   -63.01    
           dB_d2( 22,  7) =    3.857    
           dB_d2( 22,  8) =    119.1    
           dB_d2( 22,  9) =    24.47    
           dB_d2( 22, 10) =    56.40    
           dB_d2( 22, 11) =    53.15    
           dB_d2( 22, 12) =    146.1    
           dB_d2( 22, 13) =    22.24    
           dB_d2( 22, 14) =    14.64    
           dB_d2( 22, 15) =    9.377    
           dB_d2( 22, 16) =   -101.3    
           dB_d2( 22, 17) =    10.15    
           dB_d2( 22, 18) =   -48.60    
           dB_d2( 22, 19) =    5.734    
           dB_d2( 22, 20) =    3.320    
           dB_d2( 22, 21) =    1.903    
           dB_d2( 22, 22) =   -2.935    
           dB_d2( 22, 23) =   -9.115    
           dB_d2( 22, 24) =   -2.703    
           dB_d2( 22, 25) =    7.858    
           dB_d2( 22, 26) =   -13.18    
           dB_d2( 22, 27) =   -5.570    
           dB_d2( 22, 28) =   -52.72    
           dB_d2( 23,  1) =   -26.83    
           dB_d2( 23,  2) =    38.99    
           dB_d2( 23,  3) =   -6.671    
           dB_d2( 23,  4) =    79.65    
           dB_d2( 23,  5) =   -115.5    
           dB_d2( 23,  6) =    60.88    
           dB_d2( 23,  7) =   -35.15    
           dB_d2( 23,  8) =    351.1    
           dB_d2( 23,  9) =    25.03    
           dB_d2( 23, 10) =    70.99    
           dB_d2( 23, 11) =    25.33    
           dB_d2( 23, 12) =    226.6    
           dB_d2( 23, 13) =    4.545    
           dB_d2( 23, 14) =    55.15    
           dB_d2( 23, 15) =   -3.859    
           dB_d2( 23, 16) =   -146.4    
           dB_d2( 23, 17) =    1.715    
           dB_d2( 23, 18) =   -16.59    
           dB_d2( 23, 19) =    2.245    
           dB_d2( 23, 20) =   -39.28    
           dB_d2( 23, 21) =   -17.38    
           dB_d2( 23, 22) =    50.31    
           dB_d2( 23, 23) =   -10.97    
           dB_d2( 23, 24) =   -6.755    
           dB_d2( 23, 25) =   -13.08    
           dB_d2( 23, 26) =   -26.31    
           dB_d2( 23, 27) =   -9.983    
           dB_d2( 23, 28) =    25.27     
       
           ! Fill mlat arrays:
           min_mlat(  1) =     45.00
           max_mlat(  1) =     47.00
           min_mlat(  2) =     47.00
           max_mlat(  2) =     49.00
           min_mlat(  3) =     49.00
           max_mlat(  3) =     51.00
           min_mlat(  4) =     51.00
           max_mlat(  4) =     53.00
           min_mlat(  5) =     53.00
           max_mlat(  5) =     55.00
           min_mlat(  6) =     55.00
           max_mlat(  6) =     57.00
           min_mlat(  7) =     57.00
           max_mlat(  7) =     59.00
           min_mlat(  8) =     59.00
           max_mlat(  8) =     61.00
           min_mlat(  9) =     61.00
           max_mlat(  9) =     63.00
           min_mlat( 10) =     63.00
           max_mlat( 10) =     65.00
           min_mlat( 11) =     65.00
           max_mlat( 11) =     67.00
           min_mlat( 12) =     67.00
           max_mlat( 12) =     69.00
           min_mlat( 13) =     69.00
           max_mlat( 13) =     71.00
           min_mlat( 14) =     71.00
           max_mlat( 14) =     73.00
           min_mlat( 15) =     73.00
           max_mlat( 15) =     75.00
           min_mlat( 16) =     75.00
           max_mlat( 16) =     77.00
           min_mlat( 17) =     77.00
           max_mlat( 17) =     79.00
           min_mlat( 18) =     79.00
           max_mlat( 18) =     81.00
           min_mlat( 19) =     81.00
           max_mlat( 19) =     83.00
           min_mlat( 20) =     83.00
           max_mlat( 20) =     85.00
           min_mlat( 21) =     85.00
           max_mlat( 21) =     87.00
           min_mlat( 22) =     87.00
           max_mlat( 22) =     89.00
           min_mlat( 23) =     89.00
           max_mlat( 23) =     91.00
       
         end subroutine B_bmed_fill_coeff_arrays
       
       end module B_bmed_coeffmerge_mod
       
       !---------------------------------------------------------------------------
       !---------------------------------------------------------------------------
       
       subroutine B_bmed_calc_model_value(mlat_glob,mlt,sinT,imf_angle,
     |       value_Ed1,value_Ed2,value,value_found,FAC_value)
       
         ! This version is for public distribution, along with the module
         ! file coeff_mod.f90.
         !
         ! Within the /home/hensel/fortran/fit_data/public subdirectory,
         ! this program is called by call_de2_model.
       
         use B_bmed_model_mod, only: 
     |           pi,find_Btrans_function,find_imf_angle_function,
     |           find_sint_function
        
         use B_bmed_model_mod, only:  B_Bmed_number_of_MLT_coeffs,
     |       B_Bmed_number_of_Btrans_coeffs,
     |       B_Bmed_number_of_imf_angle_coeffs,
     |       B_Bmed_number_of_sinT_coeffs, AO => B_Bmed_AO,
     |       Q => B_Bmed_Q, DQ => B_Bmed_DQ,
     |       fit_by_Btrans => B_Bmed_fit_by_Btrans,fit_by_imf_angle => 
     |       B_Bmed_fit_by_imf_angle,fit_by_sinT => B_Bmed_fit_by_sinT,
     |       FAC_AO => Bmed_FAC_AO
         use qgen_mod, only: RI,ST,IBM,IEM,mcoef,dth,
     |          ns
         use common_model_mod, only: mlat_resolution,
     |          MMX,MXNMX,ITHMX,magB0_apex
       
         implicit none
       
         real, intent(in) :: mlat_glob,mlt,sinT,imf_angle
         real, intent(out) :: value_Ed1,value_Ed2,value
         logical, intent(out) :: value_found
         real, intent(out) :: FAC_value
       
         integer :: ith,m,k,ix,mm,iBtrans,iIMF_angle,isinT,fit_count, 
     |           iMLT
         integer :: m2iMLT(B_Bmed_number_of_MLT_coeffs)
         data m2iMLT /0,-1,1,-2,2,-3,3/ 
         real :: poten,etheta,ephi,x,xm1,xp1,xp2,x0,sp, 
     |         cp,sts,rst,qsoso,qsost,
     |         Btrans_function,imf_angle_function,
     |         sint_function,FAC_poten
         real :: QS(-MMX:MMX,MXNMX),DQS(-MMX:MMX,MXNMX),F(-MMX:MMX)
         real :: fac_Y,Y,sinIm,mlat,get_sinIm
       
         ! General:
         logical, parameter :: debug = .false.
       
         !****************************************************************
         ! Interpolate to get coefficients for specified mlat:
         !****************************************************************
       
         value_found = .false.
       
         ! Use absolute value of mlat:
         mlat = abs(mlat_glob)
       
         ! C Construct electric potential and electric field components 
         !C   (etheta equatorward, ephi eastward) 
         !C   on 2x10 degree grid, 0-40 colatitude
         !C Colatitudes (degrees) are in CLATD(0:ITHPLT)
         !C MLTs (hours) are in MLT(0:24)
         poten  = 0.
         etheta = 0.
         ephi   = 0.
         FAC_poten = 0.
         !C Calculate multipliers for cubic interpolation between latitudes where
         !C  Q, DQ are available
         X = (90.-mlat)*pi/180./DTH
         ITH = X
         ITH = MAX0(1,MIN0(ITHMX-2,ITH))
         X   = X - ITH
         XM1 = X*(-2. + X*(3. - X))/6.
         X0  = 1. + X*(-.5 + X*(-1. + .5*X))
         XP1 = X*(1. + X*(.5 - .5*X))
         XP2 = X*(-1. + X*X)/6.
       
         sp = sin(MLT*pi/12.)
         cp = COS(MLT*pi/12.)
         call FCMP_single(MMX,CP,SP,F)
       
         sts =  XM1* ST(ITH-1) + X0*ST(ITH)+ XP1*ST(ITH+1)+XP2*ST(ITH+2)   
       
         rst = RI*STS                                
         do iMLT = 1,B_Bmed_number_of_MLT_coeffs 
            m = m2iMLT(iMLT) 						     
            MM = IABS(M)
       
            Btrans_loop1:do iBtrans=1,1+(fit_by_Btrans
     |            *B_Bmed_number_of_Btrans_coeffs - fit_by_Btrans)
               imf_angle_loop1:do iimf_angle=1,1+(fit_by_imf_angle
     |             *B_Bmed_number_of_imf_angle_coeffs-fit_by_imf_angle)
                  imf_angle_function =  
     |                find_imf_angle_function(iimf_angle,imf_angle) 
                  sint_loop1:do isint=1,1+(fit_by_sint
     |                  *B_Bmed_number_of_sint_coeffs - fit_by_sint)
                     sint_function = find_sint_function (isint,sint)   
       
       	      do K=1,	MXNMX					     
                        IX = K - 1						
                        QS(M,K) = XM1*Q(2*IX+NS(MM),ITH-1)+ 
     |                      X0*Q(2*IX+NS(MM),ITH) 
     |                      +XP1*Q(2*IX+NS(MM),ITH+1)+
     |                      XP2*Q(2*IX+NS(MM),ITH+2)
                        DQS(M,K) = XM1*DQ(2*IX+NS(MM),ITH-1)+
     |                      X0*DQ(2*IX+NS(MM),ITH) 
     |                     +XP1*DQ(2*IX+NS(MM),ITH+1)+
     |                      XP2*DQ(2*IX+NS(MM),ITH+2)   
                        IF (ITH.GT.0) THEN
                           qsost = QS(M,K)/STS
                        ELSE
                           qsost = DQS(M,K)
                        ENDIF
                        poten  = poten  + 
     |                     AO(M,K,iBtrans,iimf_angle,isint)* 
     |                     QS(M,K)*F(M)*
     |                     imf_angle_function*sint_function 
                        etheta = etheta +  
     |                     AO(M,K,iBtrans,iimf_angle,isint)* 
     |                     DQS(M,K)*F(M)/RI*
     |                     imf_angle_function*sint_function 
                        ephi   =ephi-AO(M,K,iBtrans,iimf_angle,isint)* 
     |                      qsost*M*F(-M)/RI*
     |                      imf_angle_function*sint_function
       
                        FAC_poten  = FAC_poten  +  
     |                     FAC_AO(M,K,iBtrans,iimf_angle,isint)* 
     |                     QS(M,K)*F(M)*
     |                     imf_angle_function*sint_function 
                     enddo
                  end do sint_loop1
               end do imf_angle_loop1
            end do Btrans_loop1
         enddo
       
         sinIm     = get_sinIm (mlat)
         value     = poten
         FAC_value = FAC_poten
         value_Ed1 = etheta/abs(sin(mlat*pi/180.))  ! dBd1
         value_Ed2 = ephi/sqrt(0.25+0.75*          ! dBd2
     |         sin(mlat*pi/180.)**2)
         value_found = .true.
       
       end subroutine B_bmed_calc_model_value
       
       !---------------------------------------------------------------------------
       !---------------------------------------------------------------------------
       
       subroutine B_bmed_set_coeff_array
       
         use common_model_mod, only: nmlat,average_mlat
         use B_bmed_coeffmerge_mod, only: dB_d1,dB_d2,
     |        B_bmed_fill_coeff_arrays
         use B_bmed_model_mod, only: nfit => B_Bmed_nfit,
     |      b_Ed1 => B_Bmed_b_Ed1,b_Ed2 => B_Bmed_b_Ed2,
     |      b_interp_Ed1,b_interp_Ed2,b_90_Ed1,
     |      b_90_Ed2,x,imlat,ifit,
     |      B_Bmed_number_of_MLT_coeffs,
     |      B_Bmed_number_of_Btrans_coeffs,
     |      B_Bmed_number_of_imf_angle_coeffs,
     |      B_Bmed_number_of_sinT_coeffs,
     |      fit_by_MLT,pi,
     |      fit_by_Btrans => B_Bmed_fit_by_Btrans, 
     |      fit_by_imf_angle => B_Bmed_fit_by_imf_angle, 
     |      fit_by_sinT => B_Bmed_fit_by_sinT	   
       
       
         integer :: binary_fit_by,check_dim
         integer :: iMLT,iBtrans,iimf_angle,isinT,fit_count
         real :: fac_ed1, fac_ed2, colat
         real :: fac_Y,Y
       
         !****************************************************************
         ! Fill parameter arrays:
         !****************************************************************
         call B_bmed_fill_coeff_arrays
       
         !****************************************************************
         ! Determine array dimensions.  Arrays for data type 'potential'
         ! are the same size as arrays for other data types.
         !****************************************************************
       
         nmlat = size(dB_d1,1)
         nfit  = size(dB_d1,2)
       
         ! check dimensions
         check_dim = B_Bmed_number_of_MLT_coeffs* 
     |         B_Bmed_number_of_Btrans_coeffs*
     |         B_Bmed_number_of_imf_angle_coeffs* 
     |         B_Bmed_number_of_sinT_coeffs
         if(check_dim /= nfit) then
            write(6,'("choose_coeff_array: wrong dimensions ", 2i4)') 
     |            nfit,check_dim
            stop
         endif
         !****************************************************************
         ! Allocate arrays into which coefficients will be transferred:
         !****************************************************************
         allocate(b_Ed1(nmlat,nfit),b_Ed2(nmlat,nfit),
     |         b_interp_Ed1(nfit),
     |         b_interp_Ed2(nfit),x(nfit),
     |         b_90_Ed1(nfit),b_90_Ed2(nfit))
       
         !****************************************************************
         ! Transfer values:
         !****************************************************************
       
         do imlat=1,nmlat
            do ifit=1,nfit
               if(abs(dB_d1(imlat,ifit)) >= 0.5000E+17)  
     |            dB_d1(imlat,ifit)=0.
               if(abs(dB_d2(imlat,ifit)) >= 0.5000E+17)  
     |            dB_d2(imlat,ifit)=0.
       
               b_Ed1(imlat,ifit)=abs(sin(average_mlat(imlat)*pi/180.))* 
     |            dB_d2(imlat,ifit)/2**0.5
               b_Ed2(imlat,ifit) = sqrt(0.25+0.75*
     |            sin(average_mlat(imlat)*pi/180.)**2)* 
     |            dB_d1(imlat,ifit)/2**0.5
            end do
         end do
       
       end subroutine B_bmed_set_coeff_array
                                                                                                         
