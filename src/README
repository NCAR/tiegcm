

!======================================================================

Oct 04 -> Apr 05:

Development on tiegcm1.6 leading to tiegcm1.7, tiegcm1.8dev1, and 
tiegcm1.8dev2

!======================================================================



10/21/04: Changed #include statements from "file.h" to <file.h>.
Used perl /home/foster/tgcm/scripts/change_incs_bracks.

10/29/04:
Small change to print format statement in advance.F.
Fixed dispose.F to correct password problem in mscomment (see save/dispose.old)

!-----------------------------------------------------------------------

1/10/05:
Copied source from /home/tgcm/tiegcm1.6/src and scripts from ~/tgcm/scripts.
Modifying source for lightning linux cluster, like ~/tgcm/timegcm/src.
This is currently not a CVS working directory -- CVS working directory
is ~/tiegcm/tiegcm, but this dir (from /home/tgcm/tiegcm/src) is more
up to date. At some point (when code is working on lightning), this
should become the CVS working dir.

1/10/05:
Removed nc_xxxx routines from nchist.F, replacing them with the netcdf
functions nf_xxxx. The routine nc_get_var_real (nf_get_var_double) was
being used incorrectly (getting scalar when var is a vector with time
dimension). Now using nf_get_var1_double to get scalar at time itime. 
(see, e.g., reading f107a, f107d, etc). Same for ints that are dimensioned
in time.

1/11/05:
Determined that -fastsse does not work for dynamo (problem w/ rhs).
So mpif90 optimization should be -O2 -fast.

1/12/05:
Cleaning up for lighting: added shutdown routine (util.F), and several
other routines in util.F. Changed output, nchist, etc so that disk
file names can be used for SOURCE, OUTPUT, or SECOUT.

Changed some dimensions to avoid out-of-bounds check by the compiler.
Can now use -g -C to check for out-of-bounds. (see esp, dynamo.F, where
array() was changed to wkarray(), and put in module data).

Removed "old" dynamo option (dynamo_old.F). Now the namelist read parameter
DYNAMO <= 0 -> no dynamo, or
DYNAMO >  0 -> dynamo ("new" only)

tempdir can now be blank (which has same effect as tempdir==.).

2/2/05: This is now a CVS working directory for project tiegcm,
including scripts and src directories. Repository is /home/tgcm/cvs/tiegcm.

Feb, 2005: Rewrote timing module, as in timegcm1.2. See timing.F, and
calls in advance.F and dynamics.F.

2/10/05: Copied updated scripts from ~foster/tgcm/scripts to ~foster/tgcmtiegcm/scripts.

2/10-11/05: Verified that results are the same as 1.6: got 0 diffs between
1.6 and 1.7 runs on the same platform, and near-zero (1.e-5) diffs between
platforms.

2/11/05: Committing to CVS repository, and tagging as tiegcm1-7.

!-----------------------------------------------------------------------

Changes from tiegcm1.7 to tiegcm1.8:

2/28/05: Using k instead of k+1 in mbar calculation in dt.F.

3/18/05: 
Added check_nans, see util.F and nchist.F. Finding nans when
writing prognostic fields is fatal, see nanfatal in nchist.F.  

Putting read of magfield data file back in for use only when
dynamo==0 (was crashing on lightning). See tgcm.F and magfield.F.

Swapped loop order for efficiency near top of sub nodynamo (dynamo.F).

3/28/05:
Merged Astrid's mods to dynamo (/callisto/i/maute/teTex.d/merge_w1.7).
This included 2 new source files: highlatpoten.F and magpres_g.F.
Extensive changes to dynamo.F, current.F, apex.F.

4/4/05 btf:
Added gswm options to bndry.F, addiag.F, dt.F, and duv.F. This eliminates
source files bndry_gswm.F, addiag_gswm.F, dt_gswm.F, and duv_gswm.F.
Did "cvs remove" on the eliminated files. This will take effect with
the next cvs commit.
Also consolidated gswm calls from advance.F to sub getgswm in gswm.F.
Also changed gswm flags and file names for non-migrating tides
(i.e., gswmnmidi and gswmnmisdi changed to gswmnmdi and gswmnmsdi).

4/6/05:
CVS tagged code with "cvs -q tag tiegcm1-7+gswm+maute".
I.e., mods to tiegcm1-7 so far, including gswm and maute mods,
but prior to merging lqian code.

4/6/05:
Merged Liying's mods (lqian/):
Mods to: aurora.F, chemrates.F, dynamics.F, init.F, input.F, newton.F,
qinite.F, qrj.F, tgcm.F, util.F. Removed files xray.F and qtieff.F,
and added new source file soldata.F. There is a new namelist parameter
SD_NCFILE, specifying SEE data netcdf file. The default SEE data file
is $TGCMDATA/see__L3_merged_2005007_007.nc. 

Added this default file to scripts/MkNamelist for tiegcm (commented out). 
Also added copy of this file to exec dir by scripts/tgcm_config. The new 
MkNamelist and tgcm_config were distributed to model scripts directories 
at both hao and scd.

Added new global file attribute for sd_ncfile to histories (nchist.F).
If sd_ncfile is not in use, the attribute value is "[none]".

Commented many addfsech calls (mostly in maute code dynamo, hightlat*, 
magpres*, etc.)

CVS tagged code with "cvs -q tag tiegcm1-7+gswm+maute+lqian", but this
turned out to be incorrect -- it tags the current repository, not the
working directory from which the tag command is given. One must do a
commit, *then* save a tag.  Consequently, we do not have a version from 
after maute dynamo mods but before lqian qrj and SEE data mods.

Broke init_fields (fields.F) into 2 routines: init_4d and init_3d.
This allows compilation on certain flavors of pgf90 (e.g., on HAO Callisto)
Changes to fields.F and init.F.

4/7/05:
Doing a cvs commit, and tagging as tiegcm1-8dev1: this is leading up
to a pre-release of tiegcm1-8. This code is essentially tiegcm1-7 plus 
the following:
  -- maute dynamo mods
  -- lqian euv/qrj and SEE data option
  -- foster gswm mods (combine dt.F and dt_gswm.F, etc.)

4/19-20/05:
Copied Liying's new ~lqian/aurora.F, with qtef fix. This was causing
problems on lightning with 8 processors.

4/21/05: Made 2 10-day runs, one with periodic points and boundary
longitudes set in dt.F, and one without. Making these calls was
recommended by Wenbin (see ~foster/tgcm/tiegcm/doc/wenbin). However,
there were zero differences in all major fields after 10 days,
according to tgcmproc_f90. 

Uncommented mp_bndlons_f3d and mp_periodic_f3d in dt.F, as per
Wenbin's request.

4/22/05: 
Saving this code as "tiegcm1.8dev2", CVS tag "tiegcm1-8dev2".
