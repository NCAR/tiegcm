       module B_b0_model_mod
       
         use common_model_mod, only: MMX,MXNMX,ITHMX,NQ,pi,fit_by_MLT
         implicit none
       
         logical :: value_dummy
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Arrays for fit coefficients:
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Number of fit coefficients for each mlat:
         integer :: B_B0_nfit
         ! Fit coefficients (dimension nmlat x nfit):
         real, allocatable, dimension(:,:) :: B_B0_b_Ed1,B_B0_b_Ed2 ! nmlat x nfit
         ! Interpolated fit coefficients (dimension nfit):
         real, allocatable, dimension(:) :: b_interp_Ed1,b_interp_Ed2
         ! Fitting functions (dimension nfit):
         real, allocatable, dimension(:) :: x
         ! Fit coefficients averaged over the pole (dimension nfit):
         real, allocatable, dimension(:) :: b_90_Ed1,b_90_Ed2
         ! Number of fit functions used by fit_data:
         integer, parameter :: B_B0_number_of_MLT_coeffs = 7,
     |       B_B0_number_of_Btrans_coeffs = 2,
     |       B_B0_number_of_imf_angle_coeffs = 1,
     |       B_B0_number_of_sinT_coeffs = 2
         ! Indices:
         integer :: imlat,ifit
         ! FAC:
         real :: B0_N_AO(NQ),B0_FAC_AO(-MMX:MMX,MXNMX,
     |      B_B0_number_of_Btrans_coeffs,
     |      B_B0_number_of_imf_angle_coeffs,B_B0_number_of_sinT_coeffs)
       
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Data smoothing:
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         logical :: do_smooth
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Results
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         real :: value, value_Ed1, value_Ed2
         logical :: value_found, fit_found
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Qgen variables
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         real ::  B_B0_AO(-MMX:MMX,MXNMX,B_B0_number_of_Btrans_coeffs,
     |      B_B0_number_of_imf_angle_coeffs,B_B0_number_of_sinT_coeffs)
         real :: B_B0_Q(NQ,0:ITHMX),B_B0_DQ(NQ,0:ITHMX)
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         ! Coeffmerge
         !+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         integer, parameter :: 
     |         B_B0_fit_by_Btrans = 1,
     |         B_B0_fit_by_imf_angle = 0,
     |         B_B0_fit_by_sinT = 1   
       
       contains
       
         function find_MLT_function (index,MLT_in) result (MLT_fxn_out)
           integer :: index
           real :: MLT_in, MLT_fxn_out
       
           select case (index)
           case (0) 
              MLT_fxn_out = 1.
           case (1)
              MLT_fxn_out = 1.
           case (2)
              MLT_fxn_out = cos(pi*MLT_in/12.)
           case (3)
              MLT_fxn_out = sin(pi*MLT_in/12.)
           case (4)
              MLT_fxn_out = cos(pi*MLT_in/6.)
           case (5)
              MLT_fxn_out = sin(pi*MLT_in/6.)
           case (6)
              MLT_fxn_out = cos(pi*MLT_in/4.)
           case (7)
              MLT_fxn_out = sin(pi*MLT_in/4.)
           end select
         end function find_MLT_function
       
         function find_Btrans_function (index,Btrans_in) 
     |               result (Btrans_fxn_out)
           integer :: index
           real :: Btrans_in, Btrans_fxn_out
           real, parameter :: beta_inf = 16.
       
           select case (index)
           case (0) 
              Btrans_fxn_out = 1.
           case (1)
              Btrans_fxn_out = 1.
           case (2)
              Btrans_fxn_out = btrans_in /sqrt(1.+ 
     |         (btrans_in*btrans_in)/(beta_inf*beta_inf))
           case (3)
              Btrans_fxn_out = (Btrans_in/5.2 - 1.)**2
           end select
         end function find_Btrans_function
       
         function find_imf_angle_function (index,imf_angle_in) 
     |         result (imf_angle_fxn_out)
           integer :: index
           real :: imf_angle_in, imf_angle_fxn_out
       
           select case (index)
           case (0) 
              imf_angle_fxn_out = 1.
           case (1)
              imf_angle_fxn_out = 1.
           case (2)
              imf_angle_fxn_out = cos(imf_angle_in)
           case (3)
              imf_angle_fxn_out = sin(imf_angle_in)
           case (4)
              imf_angle_fxn_out = cos(2.*imf_angle_in)
           case (5)
              imf_angle_fxn_out = sin(2.*imf_angle_in)
           end select
         end function find_imf_angle_function
       
         function find_sinT_function (index,sinT_in)  
     |         result (sinT_fxn_out)
           integer :: index
           real :: sinT_in, sinT_fxn_out
       
           select case (index)
           case (0) 
              sinT_fxn_out = 1.
           case (1)
              sinT_fxn_out = 0.5*(1+(4.*sinT_in+0.5)/ 
     |         SQRT(0.75+(4.*sinT_in+0.5)**2))
           case (2)
              sinT_fxn_out = 0.5*(1+(4.*sinT_in+0.5)/ 
     |         SQRT(0.75+(4.*sinT_in+0.5)**2))
              sinT_fxn_out = sinT_in*sinT_fxn_out
           case (3)
              sinT_fxn_out = sinT_in**2
           end select
         end function find_sinT_function
       
       end module B_b0_model_mod
       
       !---------------------------------------------------------------------------
       !---------------------------------------------------------------------------
       
       module B_b0_coeffmerge_mod
       
         ! Merged coefficients from dB_m and dB_r to one set
         ! of Fourier series coefficients
       
         ! This module file created 2007/04/17.
         ! with the following parameters:
         !   for 81249-83047 period 
         !   fit_by_Btrans = 1
         !   fit_by_imf_angle = 0
         !   fit_by_sinT = 1
         !   mlat_resolution = 2
       
         ! To use this module, include the statement
         !   use coeffmerge_mod
         ! and the subroutine call
         !   call fill_coeff_arrays
         ! in Fortran90 programs.
         ! 
         ! Compilation will be slow; a Makefile is suggested!
         implicit none
         save
         real,  dimension( 23, 28) :: dB_d1 
         real,  dimension( 23, 28) :: dB_d2 
         real,  dimension( 23) :: min_mlat,max_mlat
       
       contains
       
         subroutine B_b0_fill_coeff_arrays 
       
           ! Fill dB_d1 arrays:
           dB_d1(  1,  1) =  -0.8827    
           dB_d1(  1,  2) =   -1.775    
           dB_d1(  1,  3) =   0.3003    
           dB_d1(  1,  4) =  -0.3095    
           dB_d1(  1,  5) =   0.1567    
           dB_d1(  1,  6) =   -3.356    
           dB_d1(  1,  7) =   0.1501    
           dB_d1(  1,  8) =    1.411    
           dB_d1(  1,  9) =  -0.3730    
           dB_d1(  1, 10) =   -11.35    
           dB_d1(  1, 11) =   0.1229    
           dB_d1(  1, 12) =  -0.7465    
           dB_d1(  1, 13) =   0.2822    
           dB_d1(  1, 14) =   -2.720    
           dB_d1(  1, 15) =   0.8190E-01
           dB_d1(  1, 16) =   0.1095    
           dB_d1(  1, 17) =   0.1277    
           dB_d1(  1, 18) =   -2.075    
           dB_d1(  1, 19) =   0.1914    
           dB_d1(  1, 20) =  -0.5805E-01
           dB_d1(  1, 21) =  -0.4918    
           dB_d1(  1, 22) =  -0.6547    
           dB_d1(  1, 23) =  -0.2116    
           dB_d1(  1, 24) =   0.2545    
           dB_d1(  1, 25) =    1.030    
           dB_d1(  1, 26) =   -1.328    
           dB_d1(  1, 27) =  -0.2968    
           dB_d1(  1, 28) =  -0.2735    
           dB_d1(  2,  1) =   -2.021    
           dB_d1(  2,  2) =    5.757    
           dB_d1(  2,  3) =   0.7740E-01
           dB_d1(  2,  4) =   -3.081    
           dB_d1(  2,  5) =   -7.097    
           dB_d1(  2,  6) =    1.292    
           dB_d1(  2,  7) =   0.1018    
           dB_d1(  2,  8) =    3.790    
           dB_d1(  2,  9) =   -4.664    
           dB_d1(  2, 10) =   -8.110    
           dB_d1(  2, 11) =  -0.4661    
           dB_d1(  2, 12) =    2.106    
           dB_d1(  2, 13) =   -6.392    
           dB_d1(  2, 14) =    1.885    
           dB_d1(  2, 15) =    1.017    
           dB_d1(  2, 16) =  -0.1325    
           dB_d1(  2, 17) =    2.067    
           dB_d1(  2, 18) =    13.72    
           dB_d1(  2, 19) =    1.336    
           dB_d1(  2, 20) =   -7.737    
           dB_d1(  2, 21) =    6.177    
           dB_d1(  2, 22) =   -21.76    
           dB_d1(  2, 23) =  -0.6921    
           dB_d1(  2, 24) =    3.520    
           dB_d1(  2, 25) =   -1.208    
           dB_d1(  2, 26) =    17.09    
           dB_d1(  2, 27) =    1.011    
           dB_d1(  2, 28) =   -5.120    
           dB_d1(  3,  1) =   -2.326    
           dB_d1(  3,  2) =    9.937    
           dB_d1(  3,  3) =  -0.7615    
           dB_d1(  3,  4) =   -1.134    
           dB_d1(  3,  5) =  -0.8870    
           dB_d1(  3,  6) =   -13.36    
           dB_d1(  3,  7) =  -0.9515    
           dB_d1(  3,  8) =    2.397    
           dB_d1(  3,  9) =    6.975    
           dB_d1(  3, 10) =   -21.78    
           dB_d1(  3, 11) =   -2.086    
           dB_d1(  3, 12) =    4.254    
           dB_d1(  3, 13) =   -6.372    
           dB_d1(  3, 14) =    8.023    
           dB_d1(  3, 15) =    1.370    
           dB_d1(  3, 16) =   0.3978    
           dB_d1(  3, 17) =    3.150    
           dB_d1(  3, 18) =    11.09    
           dB_d1(  3, 19) =   0.3600E-02
           dB_d1(  3, 20) =   -5.901    
           dB_d1(  3, 21) =    3.657    
           dB_d1(  3, 22) =   -29.61    
           dB_d1(  3, 23) =   -2.857    
           dB_d1(  3, 24) =    9.800    
           dB_d1(  3, 25) =    6.708    
           dB_d1(  3, 26) =    13.31    
           dB_d1(  3, 27) =  -0.9948    
           dB_d1(  3, 28) =   0.7655    
           dB_d1(  4,  1) =  -0.2620    
           dB_d1(  4,  2) =    3.701    
           dB_d1(  4,  3) =  -0.7035    
           dB_d1(  4,  4) =   -3.065    
           dB_d1(  4,  5) =   0.8770    
           dB_d1(  4,  6) =   -16.18    
           dB_d1(  4,  7) =   -1.876    
           dB_d1(  4,  8) =    4.157    
           dB_d1(  4,  9) =    4.543    
           dB_d1(  4, 10) =   -27.74    
           dB_d1(  4, 11) =   -3.220    
           dB_d1(  4, 12) =    6.275    
           dB_d1(  4, 13) =   -5.064    
           dB_d1(  4, 14) =   -1.282    
           dB_d1(  4, 15) =   0.6935    
           dB_d1(  4, 16) =    2.853    
           dB_d1(  4, 17) =    6.016    
           dB_d1(  4, 18) =    15.59    
           dB_d1(  4, 19) =  -0.4631    
           dB_d1(  4, 20) =   -4.655    
           dB_d1(  4, 21) =    10.62    
           dB_d1(  4, 22) =   -48.65    
           dB_d1(  4, 23) =   -2.404    
           dB_d1(  4, 24) =    9.666    
           dB_d1(  4, 25) =    2.027    
           dB_d1(  4, 26) =    20.15    
           dB_d1(  4, 27) =  -0.9134    
           dB_d1(  4, 28) =   0.3060    
           dB_d1(  5,  1) =   -2.556    
           dB_d1(  5,  2) =    10.54    
           dB_d1(  5,  3) =  -0.3701    
           dB_d1(  5,  4) =   -3.329    
           dB_d1(  5,  5) =   -5.714    
           dB_d1(  5,  6) =   -15.88    
           dB_d1(  5,  7) =   -1.808    
           dB_d1(  5,  8) =    4.981    
           dB_d1(  5,  9) =   -3.009    
           dB_d1(  5, 10) =   -4.988    
           dB_d1(  5, 11) =   -3.648    
           dB_d1(  5, 12) =    7.294    
           dB_d1(  5, 13) =    2.692    
           dB_d1(  5, 14) =   -16.56    
           dB_d1(  5, 15) =  -0.5852    
           dB_d1(  5, 16) =    5.954    
           dB_d1(  5, 17) =    9.563    
           dB_d1(  5, 18) =    11.15    
           dB_d1(  5, 19) =  -0.7613    
           dB_d1(  5, 20) =   -4.091    
           dB_d1(  5, 21) =    22.15    
           dB_d1(  5, 22) =   -72.79    
           dB_d1(  5, 23) =   -2.176    
           dB_d1(  5, 24) =    8.397    
           dB_d1(  5, 25) =    5.063    
           dB_d1(  5, 26) =    9.358    
           dB_d1(  5, 27) =  -0.9605    
           dB_d1(  5, 28) =    4.088    
           dB_d1(  6,  1) =   -3.752    
           dB_d1(  6,  2) =    21.81    
           dB_d1(  6,  3) =   0.4840E-01
           dB_d1(  6,  4) =   -2.465    
           dB_d1(  6,  5) =   -10.53    
           dB_d1(  6,  6) =   -17.48    
           dB_d1(  6,  7) =   -1.815    
           dB_d1(  6,  8) =  -0.1375    
           dB_d1(  6,  9) =   -5.989    
           dB_d1(  6, 10) =   -3.443    
           dB_d1(  6, 11) =   -4.480    
           dB_d1(  6, 12) =    13.80    
           dB_d1(  6, 13) =    3.728    
           dB_d1(  6, 14) =   -12.59    
           dB_d1(  6, 15) =   0.1210    
           dB_d1(  6, 16) =    5.816    
           dB_d1(  6, 17) =    16.61    
           dB_d1(  6, 18) =    11.58    
           dB_d1(  6, 19) =   -1.467    
           dB_d1(  6, 20) =   -8.278    
           dB_d1(  6, 21) =    30.36    
           dB_d1(  6, 22) =   -88.86    
           dB_d1(  6, 23) =   -3.472    
           dB_d1(  6, 24) =    7.615    
           dB_d1(  6, 25) =   -3.833    
           dB_d1(  6, 26) =    21.99    
           dB_d1(  6, 27) =   0.4151    
           dB_d1(  6, 28) =    7.599    
           dB_d1(  7,  1) =   -3.437    
           dB_d1(  7,  2) =    30.33    
           dB_d1(  7,  3) =  -0.5240    
           dB_d1(  7,  4) =   -3.248    
           dB_d1(  7,  5) =   -11.18    
           dB_d1(  7,  6) =   -24.75    
           dB_d1(  7,  7) =  -0.7050    
           dB_d1(  7,  8) =   -2.193    
           dB_d1(  7,  9) =   -15.31    
           dB_d1(  7, 10) =    18.91    
           dB_d1(  7, 11) =   -2.315    
           dB_d1(  7, 12) =    12.16    
           dB_d1(  7, 13) =    1.313    
           dB_d1(  7, 14) =   -5.460    
           dB_d1(  7, 15) =    3.234    
           dB_d1(  7, 16) =   -2.709    
           dB_d1(  7, 17) =    19.72    
           dB_d1(  7, 18) =   -6.455    
           dB_d1(  7, 19) =   -1.515    
           dB_d1(  7, 20) =   -6.656    
           dB_d1(  7, 21) =    28.37    
           dB_d1(  7, 22) =   -73.35    
           dB_d1(  7, 23) =   -2.461    
           dB_d1(  7, 24) =    2.323    
           dB_d1(  7, 25) =  -0.1000E-01
           dB_d1(  7, 26) =    26.72    
           dB_d1(  7, 27) =   0.1890    
           dB_d1(  7, 28) =    9.266    
           dB_d1(  8,  1) =   -9.616    
           dB_d1(  8,  2) =    39.92    
           dB_d1(  8,  3) =  -0.9800E-01
           dB_d1(  8,  4) =   -8.661    
           dB_d1(  8,  5) =   -6.882    
           dB_d1(  8,  6) =   -31.46    
           dB_d1(  8,  7) =   -2.050    
           dB_d1(  8,  8) =    8.078    
           dB_d1(  8,  9) =   -14.16    
           dB_d1(  8, 10) =    14.90    
           dB_d1(  8, 11) =   -6.181    
           dB_d1(  8, 12) =    20.20    
           dB_d1(  8, 13) =    9.804    
           dB_d1(  8, 14) =   -18.15    
           dB_d1(  8, 15) =    3.037    
           dB_d1(  8, 16) =   -9.109    
           dB_d1(  8, 17) =    15.41    
           dB_d1(  8, 18) =   -8.185    
           dB_d1(  8, 19) =  -0.8839    
           dB_d1(  8, 20) =   -6.323    
           dB_d1(  8, 21) =    27.56    
           dB_d1(  8, 22) =   -60.31    
           dB_d1(  8, 23) =   -2.822    
           dB_d1(  8, 24) =    5.628    
           dB_d1(  8, 25) =   0.7650    
           dB_d1(  8, 26) =    29.02    
           dB_d1(  8, 27) =    1.466    
           dB_d1(  8, 28) =    3.527    
           dB_d1(  9,  1) =   -17.43    
           dB_d1(  9,  2) =    56.02    
           dB_d1(  9,  3) =   0.7505    
           dB_d1(  9,  4) =   -10.12    
           dB_d1(  9,  5) =   -11.14    
           dB_d1(  9,  6) =   -27.23    
           dB_d1(  9,  7) =   0.7900    
           dB_d1(  9,  8) =    6.572    
           dB_d1(  9,  9) =   -29.01    
           dB_d1(  9, 10) =    24.35    
           dB_d1(  9, 11) =   -3.075    
           dB_d1(  9, 12) =    16.39    
           dB_d1(  9, 13) =    12.44    
           dB_d1(  9, 14) =   -50.98    
           dB_d1(  9, 15) =    2.275    
           dB_d1(  9, 16) =   -2.410    
           dB_d1(  9, 17) =   -5.514    
           dB_d1(  9, 18) =    38.69    
           dB_d1(  9, 19) =   0.3388    
           dB_d1(  9, 20) =   -6.628    
           dB_d1(  9, 21) =    28.85    
           dB_d1(  9, 22) =   -47.26    
           dB_d1(  9, 23) =   -2.875    
           dB_d1(  9, 24) =    5.612    
           dB_d1(  9, 25) =   -6.115    
           dB_d1(  9, 26) =    49.43    
           dB_d1(  9, 27) =    4.161    
           dB_d1(  9, 28) =   -4.408    
           dB_d1( 10,  1) =   -20.58    
           dB_d1( 10,  2) =    32.54    
           dB_d1( 10,  3) =  -0.6316    
           dB_d1( 10,  4) =   -3.122    
           dB_d1( 10,  5) =   -20.03    
           dB_d1( 10,  6) =   -39.13    
           dB_d1( 10,  7) =   -2.301    
           dB_d1( 10,  8) =    19.55    
           dB_d1( 10,  9) =   -88.66    
           dB_d1( 10, 10) =    106.5    
           dB_d1( 10, 11) =   -2.648    
           dB_d1( 10, 12) =    25.60    
           dB_d1( 10, 13) =    3.595    
           dB_d1( 10, 14) =   -25.22    
           dB_d1( 10, 15) =    1.243    
           dB_d1( 10, 16) =   0.6260    
           dB_d1( 10, 17) =   -30.94    
           dB_d1( 10, 18) =    94.90    
           dB_d1( 10, 19) =    3.181    
           dB_d1( 10, 20) =   -19.76    
           dB_d1( 10, 21) =    25.14    
           dB_d1( 10, 22) =   -30.60    
           dB_d1( 10, 23) =    3.200    
           dB_d1( 10, 24) =   -10.71    
           dB_d1( 10, 25) =   -10.96    
           dB_d1( 10, 26) =    57.57    
           dB_d1( 10, 27) =    5.684    
           dB_d1( 10, 28) =   -6.145    
           dB_d1( 11,  1) =   -7.186    
           dB_d1( 11,  2) =   -19.83    
           dB_d1( 11,  3) =   -3.400    
           dB_d1( 11,  4) =    1.498    
           dB_d1( 11,  5) =   -8.025    
           dB_d1( 11,  6) =   -117.4    
           dB_d1( 11,  7) =   -4.344    
           dB_d1( 11,  8) =    8.988    
           dB_d1( 11,  9) =   -191.2    
           dB_d1( 11, 10) =    290.5    
           dB_d1( 11, 11) =    5.449    
           dB_d1( 11, 12) =    5.934    
           dB_d1( 11, 13) =    1.843    
           dB_d1( 11, 14) =   -37.26    
           dB_d1( 11, 15) =    3.855    
           dB_d1( 11, 16) =   -2.641    
           dB_d1( 11, 17) =   -63.41    
           dB_d1( 11, 18) =    127.4    
           dB_d1( 11, 19) =    5.460    
           dB_d1( 11, 20) =   -16.55    
           dB_d1( 11, 21) =    15.50    
           dB_d1( 11, 22) =   -31.85    
           dB_d1( 11, 23) =    8.709    
           dB_d1( 11, 24) =   -21.68    
           dB_d1( 11, 25) =   -11.60    
           dB_d1( 11, 26) =    69.49    
           dB_d1( 11, 27) =    4.960    
           dB_d1( 11, 28) =   -10.26    
           dB_d1( 12,  1) =   -30.08    
           dB_d1( 12,  2) =    47.04    
           dB_d1( 12,  3) =    1.419    
           dB_d1( 12,  4) =   -13.82    
           dB_d1( 12,  5) =   -24.37    
           dB_d1( 12,  6) =   -81.35    
           dB_d1( 12,  7) =   0.3150E-01
           dB_d1( 12,  8) =    19.77    
           dB_d1( 12,  9) =   -246.3    
           dB_d1( 12, 10) =    427.1    
           dB_d1( 12, 11) =    16.58    
           dB_d1( 12, 12) =   -26.07    
           dB_d1( 12, 13) =    1.195    
           dB_d1( 12, 14) =   -45.49    
           dB_d1( 12, 15) =    2.992    
           dB_d1( 12, 16) =    6.150    
           dB_d1( 12, 17) =   -52.15    
           dB_d1( 12, 18) =    173.4    
           dB_d1( 12, 19) =    6.730    
           dB_d1( 12, 20) =   -35.64    
           dB_d1( 12, 21) =    3.310    
           dB_d1( 12, 22) =   -36.95    
           dB_d1( 12, 23) =    5.802    
           dB_d1( 12, 24) =   -1.705    
           dB_d1( 12, 25) =   -5.950    
           dB_d1( 12, 26) =    81.65    
           dB_d1( 12, 27) =    3.530    
           dB_d1( 12, 28) =   -5.925    
           dB_d1( 13,  1) =   -54.84    
           dB_d1( 13,  2) =    139.4    
           dB_d1( 13,  3) =    3.944    
           dB_d1( 13,  4) =   -12.92    
           dB_d1( 13,  5) =   -46.12    
           dB_d1( 13,  6) =   -13.93    
           dB_d1( 13,  7) =   -6.904    
           dB_d1( 13,  8) =    18.52    
           dB_d1( 13,  9) =   -272.6    
           dB_d1( 13, 10) =    407.6    
           dB_d1( 13, 11) =    15.00    
           dB_d1( 13, 12) =   -15.76    
           dB_d1( 13, 13) =    73.46    
           dB_d1( 13, 14) =   -172.9    
           dB_d1( 13, 15) =   -13.50    
           dB_d1( 13, 16) =    35.57    
           dB_d1( 13, 17) =   -25.09    
           dB_d1( 13, 18) =    162.8    
           dB_d1( 13, 19) =    5.267    
           dB_d1( 13, 20) =   -38.53    
           dB_d1( 13, 21) =    50.93    
           dB_d1( 13, 22) =   -127.9    
           dB_d1( 13, 23) =   -2.220    
           dB_d1( 13, 24) =    7.555    
           dB_d1( 13, 25) =    18.30    
           dB_d1( 13, 26) =    11.95    
           dB_d1( 13, 27) =   -1.485    
           dB_d1( 13, 28) =    10.42    
           dB_d1( 14,  1) =   -70.93    
           dB_d1( 14,  2) =    218.3    
           dB_d1( 14,  3) =    6.879    
           dB_d1( 14,  4) =   -13.37    
           dB_d1( 14,  5) =   -77.25    
           dB_d1( 14,  6) =    72.67    
           dB_d1( 14,  7) =  -0.7470    
           dB_d1( 14,  8) =   -9.737    
           dB_d1( 14,  9) =   -201.0    
           dB_d1( 14, 10) =    231.5    
           dB_d1( 14, 11) =  -0.6450    
           dB_d1( 14, 12) =    19.21    
           dB_d1( 14, 13) =    104.7    
           dB_d1( 14, 14) =   -217.0    
           dB_d1( 14, 15) =   -14.69    
           dB_d1( 14, 16) =    45.51    
           dB_d1( 14, 17) =    14.69    
           dB_d1( 14, 18) =    126.5    
           dB_d1( 14, 19) =    4.102    
           dB_d1( 14, 20) =   -40.64    
           dB_d1( 14, 21) =    58.45    
           dB_d1( 14, 22) =   -120.4    
           dB_d1( 14, 23) =   -1.787    
           dB_d1( 14, 24) =   -4.367    
           dB_d1( 14, 25) =    1.350    
           dB_d1( 14, 26) =    10.00    
           dB_d1( 14, 27) =    1.094    
           dB_d1( 14, 28) =    2.865    
           dB_d1( 15,  1) =   -41.72    
           dB_d1( 15,  2) =    72.82    
           dB_d1( 15,  3) =    9.868    
           dB_d1( 15,  4) =   -19.32    
           dB_d1( 15,  5) =   -51.44    
           dB_d1( 15,  6) =    118.8    
           dB_d1( 15,  7) =   -4.783    
           dB_d1( 15,  8) =  -0.4250    
           dB_d1( 15,  9) =   -76.32    
           dB_d1( 15, 10) =    38.85    
           dB_d1( 15, 11) =   -13.13    
           dB_d1( 15, 12) =    28.20    
           dB_d1( 15, 13) =    82.79    
           dB_d1( 15, 14) =   -141.4    
           dB_d1( 15, 15) =   -14.65    
           dB_d1( 15, 16) =    46.74    
           dB_d1( 15, 17) =    50.68    
           dB_d1( 15, 18) =    38.93    
           dB_d1( 15, 19) =    5.250    
           dB_d1( 15, 20) =   -36.19    
           dB_d1( 15, 21) =    24.72    
           dB_d1( 15, 22) =   -63.00    
           dB_d1( 15, 23) =    2.655    
           dB_d1( 15, 24) =   -12.80    
           dB_d1( 15, 25) =   -34.21    
           dB_d1( 15, 26) =    74.93    
           dB_d1( 15, 27) =    5.077    
           dB_d1( 15, 28) =   -13.90    
           dB_d1( 16,  1) =   -61.82    
           dB_d1( 16,  2) =    99.87    
           dB_d1( 16,  3) =    10.81    
           dB_d1( 16,  4) =   -29.17    
           dB_d1( 16,  5) =    54.61    
           dB_d1( 16,  6) =   -132.3    
           dB_d1( 16,  7) =   -11.47    
           dB_d1( 16,  8) =    16.82    
           dB_d1( 16,  9) =    75.60    
           dB_d1( 16, 10) =   -93.88    
           dB_d1( 16, 11) =   -5.170    
           dB_d1( 16, 12) =   -3.521    
           dB_d1( 16, 13) =    67.28    
           dB_d1( 16, 14) =   -94.43    
           dB_d1( 16, 15) =   -17.09    
           dB_d1( 16, 16) =    28.36    
           dB_d1( 16, 17) =    38.92    
           dB_d1( 16, 18) =   -20.35    
           dB_d1( 16, 19) =   -8.545    
           dB_d1( 16, 20) =    7.259    
           dB_d1( 16, 21) =   -33.26    
           dB_d1( 16, 22) =    94.07    
           dB_d1( 16, 23) =    16.89    
           dB_d1( 16, 24) =   -54.99    
           dB_d1( 16, 25) =   -19.08    
           dB_d1( 16, 26) =   -15.58    
           dB_d1( 16, 27) =    3.240    
           dB_d1( 16, 28) =   -1.502    
           dB_d1( 17,  1) =   -25.49    
           dB_d1( 17,  2) =    23.85    
           dB_d1( 17,  3) =    4.006    
           dB_d1( 17,  4) =   -21.80    
           dB_d1( 17,  5) =    74.53    
           dB_d1( 17,  6) =   -203.5    
           dB_d1( 17,  7) =   -11.59    
           dB_d1( 17,  8) =    68.73    
           dB_d1( 17,  9) =    197.2    
           dB_d1( 17, 10) =   -213.3    
           dB_d1( 17, 11) =    5.592    
           dB_d1( 17, 12) =    6.630    
           dB_d1( 17, 13) =    40.16    
           dB_d1( 17, 14) =   -20.01    
           dB_d1( 17, 15) =   -12.27    
           dB_d1( 17, 16) =    3.190    
           dB_d1( 17, 17) =   -14.91    
           dB_d1( 17, 18) =   -33.79    
           dB_d1( 17, 19) =   -3.110    
           dB_d1( 17, 20) =   -15.49    
           dB_d1( 17, 21) =    26.28    
           dB_d1( 17, 22) =   -113.2    
           dB_d1( 17, 23) =    3.115    
           dB_d1( 17, 24) =    19.60    
           dB_d1( 17, 25) =    12.14    
           dB_d1( 17, 26) =   -38.72    
           dB_d1( 17, 27) =   -5.101    
           dB_d1( 17, 28) =    26.83    
           dB_d1( 18,  1) =    35.24    
           dB_d1( 18,  2) =   -146.1    
           dB_d1( 18,  3) =   -5.060    
           dB_d1( 18,  4) =   -17.47    
           dB_d1( 18,  5) =    78.99    
           dB_d1( 18,  6) =    22.04    
           dB_d1( 18,  7) =   -3.207    
           dB_d1( 18,  8) =    50.93    
           dB_d1( 18,  9) =    199.5    
           dB_d1( 18, 10) =   -102.0    
           dB_d1( 18, 11) =   0.1400    
           dB_d1( 18, 12) =  -0.8650    
           dB_d1( 18, 13) =   0.9150    
           dB_d1( 18, 14) =    25.40    
           dB_d1( 18, 15) =   -13.84    
           dB_d1( 18, 16) =    7.725    
           dB_d1( 18, 17) =    3.205    
           dB_d1( 18, 18) =   -64.35    
           dB_d1( 18, 19) =    7.003    
           dB_d1( 18, 20) =   -12.79    
           dB_d1( 18, 21) =    14.59    
           dB_d1( 18, 22) =   -69.43    
           dB_d1( 18, 23) =   0.5435    
           dB_d1( 18, 24) =    7.380    
           dB_d1( 18, 25) =    21.99    
           dB_d1( 18, 26) =    40.30    
           dB_d1( 18, 27) =   -14.25    
           dB_d1( 18, 28) =    10.94    
           dB_d1( 19,  1) =    3.815    
           dB_d1( 19,  2) =   -113.6    
           dB_d1( 19,  3) =   -5.140    
           dB_d1( 19,  4) =    30.49    
           dB_d1( 19,  5) =    18.28    
           dB_d1( 19,  6) =    323.6    
           dB_d1( 19,  7) =    10.86    
           dB_d1( 19,  8) =   -65.25    
           dB_d1( 19,  9) =    199.1    
           dB_d1( 19, 10) =   -229.5    
           dB_d1( 19, 11) =   -12.16    
           dB_d1( 19, 12) =    13.53    
           dB_d1( 19, 13) =    34.69    
           dB_d1( 19, 14) =   -110.5    
           dB_d1( 19, 15) =   -18.13    
           dB_d1( 19, 16) =    67.88    
           dB_d1( 19, 17) =    18.26    
           dB_d1( 19, 18) =   -37.42    
           dB_d1( 19, 19) =    12.99    
           dB_d1( 19, 20) =   -23.64    
           dB_d1( 19, 21) =   -2.985    
           dB_d1( 19, 22) =    44.84    
           dB_d1( 19, 23) =   -3.959    
           dB_d1( 19, 24) =   -26.21    
           dB_d1( 19, 25) =    10.26    
           dB_d1( 19, 26) =    6.815    
           dB_d1( 19, 27) =   -13.50    
           dB_d1( 19, 28) =    2.930    
           dB_d1( 20,  1) =   -25.94    
           dB_d1( 20,  2) =   -19.48    
           dB_d1( 20,  3) =    3.730    
           dB_d1( 20,  4) =    36.77    
           dB_d1( 20,  5) =    108.1    
           dB_d1( 20,  6) =   -57.92    
           dB_d1( 20,  7) =   -9.585    
           dB_d1( 20,  8) =   -23.34    
           dB_d1( 20,  9) =    169.0    
           dB_d1( 20, 10) =   -136.6    
           dB_d1( 20, 11) =   -3.570    
           dB_d1( 20, 12) =   -69.29    
           dB_d1( 20, 13) =    25.65    
           dB_d1( 20, 14) =   -74.35    
           dB_d1( 20, 15) =   -3.118    
           dB_d1( 20, 16) =    14.98    
           dB_d1( 20, 17) =   -14.81    
           dB_d1( 20, 18) =    98.24    
           dB_d1( 20, 19) =    16.74    
           dB_d1( 20, 20) =   -11.45    
           dB_d1( 20, 21) =    22.66    
           dB_d1( 20, 22) =   -60.50    
           dB_d1( 20, 23) =   -16.88    
           dB_d1( 20, 24) =    42.08    
           dB_d1( 20, 25) =   -17.15    
           dB_d1( 20, 26) =   -28.10    
           dB_d1( 20, 27) =   -6.340    
           dB_d1( 20, 28) =   -8.680    
           dB_d1( 21,  1) =    23.32    
           dB_d1( 21,  2) =   -66.03    
           dB_d1( 21,  3) =   -3.415    
           dB_d1( 21,  4) =   -10.16    
           dB_d1( 21,  5) =    159.4    
           dB_d1( 21,  6) =   -103.5    
           dB_d1( 21,  7) =   -32.39    
           dB_d1( 21,  8) =    54.61    
           dB_d1( 21,  9) =    189.5    
           dB_d1( 21, 10) =   -130.5    
           dB_d1( 21, 11) =   -25.23    
           dB_d1( 21, 12) =   0.6915    
           dB_d1( 21, 13) =    3.670    
           dB_d1( 21, 14) =    58.17    
           dB_d1( 21, 15) =   -2.059    
           dB_d1( 21, 16) =   -22.99    
           dB_d1( 21, 17) =   -21.94    
           dB_d1( 21, 18) =   -20.20    
           dB_d1( 21, 19) =    22.06    
           dB_d1( 21, 20) =   -1.270    
           dB_d1( 21, 21) =    39.08    
           dB_d1( 21, 22) =  -0.1100    
           dB_d1( 21, 23) =   -8.288    
           dB_d1( 21, 24) =    23.39    
           dB_d1( 21, 25) =    9.255    
           dB_d1( 21, 26) =    95.22    
           dB_d1( 21, 27) =   -11.43    
           dB_d1( 21, 28) =   -15.09    
           dB_d1( 22,  1) =    30.39    
           dB_d1( 22,  2) =   -27.00    
           dB_d1( 22,  3) =   -6.073    
           dB_d1( 22,  4) =   -12.99    
           dB_d1( 22,  5) =    165.4    
           dB_d1( 22,  6) =   -226.5    
           dB_d1( 22,  7) =   -17.23    
           dB_d1( 22,  8) =    58.56    
           dB_d1( 22,  9) =    158.3    
           dB_d1( 22, 10) =   -60.34    
           dB_d1( 22, 11) =   -26.89    
           dB_d1( 22, 12) =   -2.975    
           dB_d1( 22, 13) =  -0.2350    
           dB_d1( 22, 14) =    30.75    
           dB_d1( 22, 15) =   -9.337    
           dB_d1( 22, 16) =   -5.680    
           dB_d1( 22, 17) =   -32.28    
           dB_d1( 22, 18) =    77.19    
           dB_d1( 22, 19) =    13.39    
           dB_d1( 22, 20) =   -19.67    
           dB_d1( 22, 21) =   -5.748    
           dB_d1( 22, 22) =    147.4    
           dB_d1( 22, 23) =    5.817    
           dB_d1( 22, 24) =   -11.23    
           dB_d1( 22, 25) =    35.06    
           dB_d1( 22, 26) =    17.47    
           dB_d1( 22, 27) =   -7.844    
           dB_d1( 22, 28) =    9.615    
           dB_d1( 23,  1) =    60.44    
           dB_d1( 23,  2) =    10.44    
           dB_d1( 23,  3) =   -9.455    
           dB_d1( 23,  4) =   -23.03    
           dB_d1( 23,  5) =    93.18    
           dB_d1( 23,  6) =   -7.145    
           dB_d1( 23,  7) =   -1.033    
           dB_d1( 23,  8) =   -12.28    
           dB_d1( 23,  9) =    182.3    
           dB_d1( 23, 10) =   -151.4    
           dB_d1( 23, 11) =   -20.49    
           dB_d1( 23, 12) =    36.13    
           dB_d1( 23, 13) =    41.56    
           dB_d1( 23, 14) =    39.67    
           dB_d1( 23, 15) =   -5.155    
           dB_d1( 23, 16) =   -3.290    
           dB_d1( 23, 17) =   -74.50    
           dB_d1( 23, 18) =   -12.13    
           dB_d1( 23, 19) =    21.00    
           dB_d1( 23, 20) =    46.75    
           dB_d1( 23, 21) =    1.005    
           dB_d1( 23, 22) =    38.47    
           dB_d1( 23, 23) =   -8.879    
           dB_d1( 23, 24) =    55.81    
           dB_d1( 23, 25) =    39.67    
           dB_d1( 23, 26) =   -12.90    
           dB_d1( 23, 27) =   -4.301    
           dB_d1( 23, 28) =    5.235    
       
           ! Fill dB_d2 arrays:
           dB_d2(  1,  1) =  -0.2210    
           dB_d2(  1,  2) =    5.419    
           dB_d2(  1,  3) =  -0.1742    
           dB_d2(  1,  4) =  -0.3832    
           dB_d2(  1,  5) =   0.3830    
           dB_d2(  1,  6) =   -4.134    
           dB_d2(  1,  7) =   -1.092    
           dB_d2(  1,  8) =    5.818    
           dB_d2(  1,  9) =    1.809    
           dB_d2(  1, 10) =   -1.214    
           dB_d2(  1, 11) =  -0.3450    
           dB_d2(  1, 12) =   0.2592    
           dB_d2(  1, 13) =  -0.1277    
           dB_d2(  1, 14) =    2.075    
           dB_d2(  1, 15) =  -0.1914    
           dB_d2(  1, 16) =   0.5805E-01
           dB_d2(  1, 17) =   0.2822    
           dB_d2(  1, 18) =   -2.720    
           dB_d2(  1, 19) =   0.8190E-01
           dB_d2(  1, 20) =   0.1095    
           dB_d2(  1, 21) =   -1.030    
           dB_d2(  1, 22) =    1.328    
           dB_d2(  1, 23) =   0.2968    
           dB_d2(  1, 24) =   0.2735    
           dB_d2(  1, 25) =  -0.4918    
           dB_d2(  1, 26) =  -0.6547    
           dB_d2(  1, 27) =  -0.2116    
           dB_d2(  1, 28) =   0.2545    
           dB_d2(  2,  1) =   -7.305    
           dB_d2(  2,  2) =    17.75    
           dB_d2(  2,  3) =   -1.643    
           dB_d2(  2,  4) =    6.143    
           dB_d2(  2,  5) =   -6.888    
           dB_d2(  2,  6) =    18.05    
           dB_d2(  2,  7) =   -2.096    
           dB_d2(  2,  8) =    7.734    
           dB_d2(  2,  9) =   -9.302    
           dB_d2(  2, 10) =    44.13    
           dB_d2(  2, 11) =    1.640    
           dB_d2(  2, 12) =   -5.768    
           dB_d2(  2, 13) =   -2.067    
           dB_d2(  2, 14) =   -13.72    
           dB_d2(  2, 15) =   -1.336    
           dB_d2(  2, 16) =    7.737    
           dB_d2(  2, 17) =   -6.392    
           dB_d2(  2, 18) =    1.885    
           dB_d2(  2, 19) =    1.017    
           dB_d2(  2, 20) =  -0.1325    
           dB_d2(  2, 21) =    1.208    
           dB_d2(  2, 22) =   -17.09    
           dB_d2(  2, 23) =   -1.011    
           dB_d2(  2, 24) =    5.120    
           dB_d2(  2, 25) =    6.177    
           dB_d2(  2, 26) =   -21.76    
           dB_d2(  2, 27) =  -0.6921    
           dB_d2(  2, 28) =    3.520    
           dB_d2(  3,  1) =   -15.47    
           dB_d2(  3,  2) =    32.17    
           dB_d2(  3,  3) =   0.6578    
           dB_d2(  3,  4) =    4.288    
           dB_d2(  3,  5) =   -9.647    
           dB_d2(  3,  6) =    39.92    
           dB_d2(  3,  7) =  -0.1960    
           dB_d2(  3,  8) =  -0.6215    
           dB_d2(  3,  9) =    6.451    
           dB_d2(  3, 10) =    7.556    
           dB_d2(  3, 11) =   -1.476    
           dB_d2(  3, 12) =    2.033    
           dB_d2(  3, 13) =   -3.150    
           dB_d2(  3, 14) =   -11.09    
           dB_d2(  3, 15) =  -0.3600E-02
           dB_d2(  3, 16) =    5.901    
           dB_d2(  3, 17) =   -6.372    
           dB_d2(  3, 18) =    8.023    
           dB_d2(  3, 19) =    1.370    
           dB_d2(  3, 20) =   0.3978    
           dB_d2(  3, 21) =   -6.708    
           dB_d2(  3, 22) =   -13.31    
           dB_d2(  3, 23) =   0.9948    
           dB_d2(  3, 24) =  -0.7655    
           dB_d2(  3, 25) =    3.657    
           dB_d2(  3, 26) =   -29.61    
           dB_d2(  3, 27) =   -2.857    
           dB_d2(  3, 28) =    9.800    
           dB_d2(  4,  1) =   -4.273    
           dB_d2(  4,  2) =    5.155    
           dB_d2(  4,  3) =  -0.2541    
           dB_d2(  4,  4) =    3.224    
           dB_d2(  4,  5) =   -13.91    
           dB_d2(  4,  6) =    24.82    
           dB_d2(  4,  7) =    3.748    
           dB_d2(  4,  8) =    1.169    
           dB_d2(  4,  9) =   -3.337    
           dB_d2(  4, 10) =    7.738    
           dB_d2(  4, 11) =  -0.2235    
           dB_d2(  4, 12) =   0.4900E-01
           dB_d2(  4, 13) =   -6.016    
           dB_d2(  4, 14) =   -15.59    
           dB_d2(  4, 15) =   0.4631    
           dB_d2(  4, 16) =    4.655    
           dB_d2(  4, 17) =   -5.064    
           dB_d2(  4, 18) =   -1.282    
           dB_d2(  4, 19) =   0.6935    
           dB_d2(  4, 20) =    2.853    
           dB_d2(  4, 21) =   -2.027    
           dB_d2(  4, 22) =   -20.15    
           dB_d2(  4, 23) =   0.9134    
           dB_d2(  4, 24) =  -0.3060    
           dB_d2(  4, 25) =    10.62    
           dB_d2(  4, 26) =   -48.65    
           dB_d2(  4, 27) =   -2.404    
           dB_d2(  4, 28) =    9.666    
           dB_d2(  5,  1) =   -11.89    
           dB_d2(  5,  2) =    32.35    
           dB_d2(  5,  3) =   0.3977    
           dB_d2(  5,  4) =   0.4770    
           dB_d2(  5,  5) =   -22.70    
           dB_d2(  5,  6) =    22.05    
           dB_d2(  5,  7) =    5.306    
           dB_d2(  5,  8) =    1.320    
           dB_d2(  5,  9) =   -9.144    
           dB_d2(  5, 10) =    20.33    
           dB_d2(  5, 11) =    1.493    
           dB_d2(  5, 12) =   -2.505    
           dB_d2(  5, 13) =   -9.563    
           dB_d2(  5, 14) =   -11.15    
           dB_d2(  5, 15) =   0.7613    
           dB_d2(  5, 16) =    4.091    
           dB_d2(  5, 17) =    2.692    
           dB_d2(  5, 18) =   -16.56    
           dB_d2(  5, 19) =  -0.5852    
           dB_d2(  5, 20) =    5.954    
           dB_d2(  5, 21) =   -5.063    
           dB_d2(  5, 22) =   -9.358    
           dB_d2(  5, 23) =   0.9605    
           dB_d2(  5, 24) =   -4.088    
           dB_d2(  5, 25) =    22.15    
           dB_d2(  5, 26) =   -72.79    
           dB_d2(  5, 27) =   -2.176    
           dB_d2(  5, 28) =    8.397    
           dB_d2(  6,  1) =   -2.185    
           dB_d2(  6,  2) =    20.89    
           dB_d2(  6,  3) =   0.3350E-01
           dB_d2(  6,  4) =  -0.6625    
           dB_d2(  6,  5) =   -21.34    
           dB_d2(  6,  6) =    12.91    
           dB_d2(  6,  7) =    2.652    
           dB_d2(  6,  8) =    3.586    
           dB_d2(  6,  9) =    14.61    
           dB_d2(  6, 10) =   -41.56    
           dB_d2(  6, 11) =   -1.804    
           dB_d2(  6, 12) =    3.919    
           dB_d2(  6, 13) =   -16.61    
           dB_d2(  6, 14) =   -11.58    
           dB_d2(  6, 15) =    1.467    
           dB_d2(  6, 16) =    8.278    
           dB_d2(  6, 17) =    3.728    
           dB_d2(  6, 18) =   -12.59    
           dB_d2(  6, 19) =   0.1210    
           dB_d2(  6, 20) =    5.816    
           dB_d2(  6, 21) =    3.833    
           dB_d2(  6, 22) =   -21.99    
           dB_d2(  6, 23) =  -0.4151    
           dB_d2(  6, 24) =   -7.599    
           dB_d2(  6, 25) =    30.36    
           dB_d2(  6, 26) =   -88.86    
           dB_d2(  6, 27) =   -3.472    
           dB_d2(  6, 28) =    7.615    
           dB_d2(  7,  1) =    4.655    
           dB_d2(  7,  2) =    19.16    
           dB_d2(  7,  3) =  -0.6780    
           dB_d2(  7,  4) =   0.2830    
           dB_d2(  7,  5) =   -20.81    
           dB_d2(  7,  6) =   -2.170    
           dB_d2(  7,  7) =   0.1330    
           dB_d2(  7,  8) =    9.229    
           dB_d2(  7,  9) =    9.080    
           dB_d2(  7, 10) =   -34.29    
           dB_d2(  7, 11) =   -1.837    
           dB_d2(  7, 12) =    6.689    
           dB_d2(  7, 13) =   -19.72    
           dB_d2(  7, 14) =    6.455    
           dB_d2(  7, 15) =    1.515    
           dB_d2(  7, 16) =    6.656    
           dB_d2(  7, 17) =    1.313    
           dB_d2(  7, 18) =   -5.460    
           dB_d2(  7, 19) =    3.234    
           dB_d2(  7, 20) =   -2.709    
           dB_d2(  7, 21) =   0.1000E-01
           dB_d2(  7, 22) =   -26.72    
           dB_d2(  7, 23) =  -0.1890    
           dB_d2(  7, 24) =   -9.266    
           dB_d2(  7, 25) =    28.37    
           dB_d2(  7, 26) =   -73.35    
           dB_d2(  7, 27) =   -2.461    
           dB_d2(  7, 28) =    2.323    
           dB_d2(  8,  1) =    1.525    
           dB_d2(  8,  2) =    38.92    
           dB_d2(  8,  3) =    1.445    
           dB_d2(  8,  4) =   -1.241    
           dB_d2(  8,  5) =   -39.17    
           dB_d2(  8,  6) =    2.785    
           dB_d2(  8,  7) =    1.643    
           dB_d2(  8,  8) =    6.064    
           dB_d2(  8,  9) =   -2.202    
           dB_d2(  8, 10) =   -10.86    
           dB_d2(  8, 11) =   -2.930    
           dB_d2(  8, 12) =    15.64    
           dB_d2(  8, 13) =   -15.41    
           dB_d2(  8, 14) =    8.185    
           dB_d2(  8, 15) =   0.8839    
           dB_d2(  8, 16) =    6.323    
           dB_d2(  8, 17) =    9.804    
           dB_d2(  8, 18) =   -18.15    
           dB_d2(  8, 19) =    3.037    
           dB_d2(  8, 20) =   -9.109    
           dB_d2(  8, 21) =  -0.7650    
           dB_d2(  8, 22) =   -29.02    
           dB_d2(  8, 23) =   -1.466    
           dB_d2(  8, 24) =   -3.527    
           dB_d2(  8, 25) =    27.56    
           dB_d2(  8, 26) =   -60.31    
           dB_d2(  8, 27) =   -2.822    
           dB_d2(  8, 28) =    5.628    
           dB_d2(  9,  1) =    6.006    
           dB_d2(  9,  2) =    32.49    
           dB_d2(  9,  3) =   0.6150    
           dB_d2(  9,  4) =   0.3305    
           dB_d2(  9,  5) =   -62.17    
           dB_d2(  9,  6) =    22.31    
           dB_d2(  9,  7) =    5.342    
           dB_d2(  9,  8) =    3.717    
           dB_d2(  9,  9) =   -25.24    
           dB_d2(  9, 10) =    51.61    
           dB_d2(  9, 11) =   0.5000E-02
           dB_d2(  9, 12) =    7.464    
           dB_d2(  9, 13) =    5.514    
           dB_d2(  9, 14) =   -38.69    
           dB_d2(  9, 15) =  -0.3388    
           dB_d2(  9, 16) =    6.628    
           dB_d2(  9, 17) =    12.44    
           dB_d2(  9, 18) =   -50.98    
           dB_d2(  9, 19) =    2.275    
           dB_d2(  9, 20) =   -2.410    
           dB_d2(  9, 21) =    6.115    
           dB_d2(  9, 22) =   -49.43    
           dB_d2(  9, 23) =   -4.161    
           dB_d2(  9, 24) =    4.408    
           dB_d2(  9, 25) =    28.85    
           dB_d2(  9, 26) =   -47.26    
           dB_d2(  9, 27) =   -2.875    
           dB_d2(  9, 28) =    5.612    
           dB_d2( 10,  1) =    3.190    
           dB_d2( 10,  2) =    48.60    
           dB_d2( 10,  3) =   -1.624    
           dB_d2( 10,  4) =    7.585    
           dB_d2( 10,  5) =   -68.79    
           dB_d2( 10,  6) =   -17.02    
           dB_d2( 10,  7) =    4.546    
           dB_d2( 10,  8) =    8.053    
           dB_d2( 10,  9) =   -56.67    
           dB_d2( 10, 10) =    125.9    
           dB_d2( 10, 11) =    5.921    
           dB_d2( 10, 12) =   -11.65    
           dB_d2( 10, 13) =    30.94    
           dB_d2( 10, 14) =   -94.90    
           dB_d2( 10, 15) =   -3.181    
           dB_d2( 10, 16) =    19.76    
           dB_d2( 10, 17) =    3.595    
           dB_d2( 10, 18) =   -25.22    
           dB_d2( 10, 19) =    1.243    
           dB_d2( 10, 20) =   0.6260    
           dB_d2( 10, 21) =    10.96    
           dB_d2( 10, 22) =   -57.57    
           dB_d2( 10, 23) =   -5.684    
           dB_d2( 10, 24) =    6.145    
           dB_d2( 10, 25) =    25.14    
           dB_d2( 10, 26) =   -30.60    
           dB_d2( 10, 27) =    3.200    
           dB_d2( 10, 28) =   -10.71    
           dB_d2( 11,  1) =   -17.63    
           dB_d2( 11,  2) =    116.9    
           dB_d2( 11,  3) =   0.5415    
           dB_d2( 11,  4) =   -1.865    
           dB_d2( 11,  5) =   -92.82    
           dB_d2( 11,  6) =   -31.29    
           dB_d2( 11,  7) =    6.152    
           dB_d2( 11,  8) =    11.61    
           dB_d2( 11,  9) =   -119.2    
           dB_d2( 11, 10) =    267.9    
           dB_d2( 11, 11) =    15.56    
           dB_d2( 11, 12) =   -34.53    
           dB_d2( 11, 13) =    63.41    
           dB_d2( 11, 14) =   -127.4    
           dB_d2( 11, 15) =   -5.460    
           dB_d2( 11, 16) =    16.55    
           dB_d2( 11, 17) =    1.843    
           dB_d2( 11, 18) =   -37.26    
           dB_d2( 11, 19) =    3.855    
           dB_d2( 11, 20) =   -2.641    
           dB_d2( 11, 21) =    11.60    
           dB_d2( 11, 22) =   -69.49    
           dB_d2( 11, 23) =   -4.960    
           dB_d2( 11, 24) =    10.26    
           dB_d2( 11, 25) =    15.50    
           dB_d2( 11, 26) =   -31.85    
           dB_d2( 11, 27) =    8.709    
           dB_d2( 11, 28) =   -21.68    
           dB_d2( 12,  1) =   -37.71    
           dB_d2( 12,  2) =    144.0    
           dB_d2( 12,  3) =    5.790    
           dB_d2( 12,  4) =   -9.160    
           dB_d2( 12,  5) =   -141.6    
           dB_d2( 12,  6) =    94.65    
           dB_d2( 12,  7) =    11.44    
           dB_d2( 12,  8) =   -7.037    
           dB_d2( 12,  9) =   -161.1    
           dB_d2( 12, 10) =    299.5    
           dB_d2( 12, 11) =    21.97    
           dB_d2( 12, 12) =   -36.78    
           dB_d2( 12, 13) =    52.15    
           dB_d2( 12, 14) =   -173.4    
           dB_d2( 12, 15) =   -6.730    
           dB_d2( 12, 16) =    35.64    
           dB_d2( 12, 17) =    1.195    
           dB_d2( 12, 18) =   -45.49    
           dB_d2( 12, 19) =    2.992    
           dB_d2( 12, 20) =    6.150    
           dB_d2( 12, 21) =    5.950    
           dB_d2( 12, 22) =   -81.65    
           dB_d2( 12, 23) =   -3.530    
           dB_d2( 12, 24) =    5.925    
           dB_d2( 12, 25) =    3.310    
           dB_d2( 12, 26) =   -36.95    
           dB_d2( 12, 27) =    5.802    
           dB_d2( 12, 28) =   -1.705    
           dB_d2( 13,  1) =   -21.57    
           dB_d2( 13,  2) =    113.5    
           dB_d2( 13,  3) =    5.533    
           dB_d2( 13,  4) =   -7.505    
           dB_d2( 13,  5) =   -125.3    
           dB_d2( 13,  6) =    114.8    
           dB_d2( 13,  7) =    11.25    
           dB_d2( 13,  8) =   -27.03    
           dB_d2( 13,  9) =   -122.9    
           dB_d2( 13, 10) =    265.9    
           dB_d2( 13, 11) =    15.38    
           dB_d2( 13, 12) =   -30.82    
           dB_d2( 13, 13) =    25.09    
           dB_d2( 13, 14) =   -162.8    
           dB_d2( 13, 15) =   -5.267    
           dB_d2( 13, 16) =    38.53    
           dB_d2( 13, 17) =    73.46    
           dB_d2( 13, 18) =   -172.9    
           dB_d2( 13, 19) =   -13.50    
           dB_d2( 13, 20) =    35.57    
           dB_d2( 13, 21) =   -18.30    
           dB_d2( 13, 22) =   -11.95    
           dB_d2( 13, 23) =    1.485    
           dB_d2( 13, 24) =   -10.42    
           dB_d2( 13, 25) =    50.93    
           dB_d2( 13, 26) =   -127.9    
           dB_d2( 13, 27) =   -2.220    
           dB_d2( 13, 28) =    7.555    
           dB_d2( 14,  1) =    2.855    
           dB_d2( 14,  2) =    87.81    
           dB_d2( 14,  3) =    2.627    
           dB_d2( 14,  4) =   -13.62    
           dB_d2( 14,  5) =   -114.7    
           dB_d2( 14,  6) =    86.69    
           dB_d2( 14,  7) =    9.371    
           dB_d2( 14,  8) =   -19.71    
           dB_d2( 14,  9) =   -105.1    
           dB_d2( 14, 10) =    235.7    
           dB_d2( 14, 11) =    14.59    
           dB_d2( 14, 12) =   -31.32    
           dB_d2( 14, 13) =   -14.69    
           dB_d2( 14, 14) =   -126.5    
           dB_d2( 14, 15) =   -4.102    
           dB_d2( 14, 16) =    40.64    
           dB_d2( 14, 17) =    104.7    
           dB_d2( 14, 18) =   -217.0    
           dB_d2( 14, 19) =   -14.69    
           dB_d2( 14, 20) =    45.51    
           dB_d2( 14, 21) =   -1.350    
           dB_d2( 14, 22) =   -10.00    
           dB_d2( 14, 23) =   -1.094    
           dB_d2( 14, 24) =   -2.865    
           dB_d2( 14, 25) =    58.45    
           dB_d2( 14, 26) =   -120.4    
           dB_d2( 14, 27) =   -1.787    
           dB_d2( 14, 28) =   -4.367    
           dB_d2( 15,  1) =  -0.2000E-01
           dB_d2( 15,  2) =    87.38    
           dB_d2( 15,  3) =    1.167    
           dB_d2( 15,  4) =   -15.45    
           dB_d2( 15,  5) =   -132.3    
           dB_d2( 15,  6) =    103.9    
           dB_d2( 15,  7) =    7.269    
           dB_d2( 15,  8) =   -21.82    
           dB_d2( 15,  9) =   -98.10    
           dB_d2( 15, 10) =    299.4    
           dB_d2( 15, 11) =    23.39    
           dB_d2( 15, 12) =   -66.65    
           dB_d2( 15, 13) =   -50.68    
           dB_d2( 15, 14) =   -38.93    
           dB_d2( 15, 15) =   -5.250    
           dB_d2( 15, 16) =    36.19    
           dB_d2( 15, 17) =    82.79    
           dB_d2( 15, 18) =   -141.4    
           dB_d2( 15, 19) =   -14.65    
           dB_d2( 15, 20) =    46.74    
           dB_d2( 15, 21) =    34.21    
           dB_d2( 15, 22) =   -74.93    
           dB_d2( 15, 23) =   -5.077    
           dB_d2( 15, 24) =    13.90    
           dB_d2( 15, 25) =    24.72    
           dB_d2( 15, 26) =   -63.00    
           dB_d2( 15, 27) =    2.655    
           dB_d2( 15, 28) =   -12.80    
           dB_d2( 16,  1) =   -27.98    
           dB_d2( 16,  2) =    161.4    
           dB_d2( 16,  3) =  -0.5135    
           dB_d2( 16,  4) =    4.881    
           dB_d2( 16,  5) =   -146.0    
           dB_d2( 16,  6) =    112.5    
           dB_d2( 16,  7) =    7.094    
           dB_d2( 16,  8) =   -15.58    
           dB_d2( 16,  9) =   -34.85    
           dB_d2( 16, 10) =    192.6    
           dB_d2( 16, 11) =    15.11    
           dB_d2( 16, 12) =   -53.89    
           dB_d2( 16, 13) =   -38.92    
           dB_d2( 16, 14) =    20.35    
           dB_d2( 16, 15) =    8.545    
           dB_d2( 16, 16) =   -7.259    
           dB_d2( 16, 17) =    67.28    
           dB_d2( 16, 18) =   -94.43    
           dB_d2( 16, 19) =   -17.09    
           dB_d2( 16, 20) =    28.36    
           dB_d2( 16, 21) =    19.08    
           dB_d2( 16, 22) =    15.58    
           dB_d2( 16, 23) =   -3.240    
           dB_d2( 16, 24) =    1.502    
           dB_d2( 16, 25) =   -33.26    
           dB_d2( 16, 26) =    94.07    
           dB_d2( 16, 27) =    16.89    
           dB_d2( 16, 28) =   -54.99    
           dB_d2( 17,  1) =   -23.98    
           dB_d2( 17,  2) =    86.61    
           dB_d2( 17,  3) =  -0.3400    
           dB_d2( 17,  4) =    44.37    
           dB_d2( 17,  5) =   -150.4    
           dB_d2( 17,  6) =    123.5    
           dB_d2( 17,  7) =    13.13    
           dB_d2( 17,  8) =   -80.65    
           dB_d2( 17,  9) =    11.47    
           dB_d2( 17, 10) =    182.4    
           dB_d2( 17, 11) =    11.77    
           dB_d2( 17, 12) =   -44.29    
           dB_d2( 17, 13) =    14.91    
           dB_d2( 17, 14) =    33.79    
           dB_d2( 17, 15) =    3.110    
           dB_d2( 17, 16) =    15.49    
           dB_d2( 17, 17) =    40.16    
           dB_d2( 17, 18) =   -20.01    
           dB_d2( 17, 19) =   -12.27    
           dB_d2( 17, 20) =    3.190    
           dB_d2( 17, 21) =   -12.14    
           dB_d2( 17, 22) =    38.72    
           dB_d2( 17, 23) =    5.101    
           dB_d2( 17, 24) =   -26.83    
           dB_d2( 17, 25) =    26.28    
           dB_d2( 17, 26) =   -113.2    
           dB_d2( 17, 27) =    3.115    
           dB_d2( 17, 28) =    19.60    
           dB_d2( 18,  1) =   -26.27    
           dB_d2( 18,  2) =    56.55    
           dB_d2( 18,  3) =   -3.987    
           dB_d2( 18,  4) =    38.49    
           dB_d2( 18,  5) =   -164.5    
           dB_d2( 18,  6) =    176.4    
           dB_d2( 18,  7) =    17.47    
           dB_d2( 18,  8) =   -57.25    
           dB_d2( 18,  9) =    26.13    
           dB_d2( 18, 10) =    133.6    
           dB_d2( 18, 11) =    3.664    
           dB_d2( 18, 12) =   -25.79    
           dB_d2( 18, 13) =   -3.205    
           dB_d2( 18, 14) =    64.35    
           dB_d2( 18, 15) =   -7.003    
           dB_d2( 18, 16) =    12.79    
           dB_d2( 18, 17) =   0.9150    
           dB_d2( 18, 18) =    25.40    
           dB_d2( 18, 19) =   -13.84    
           dB_d2( 18, 20) =    7.725    
           dB_d2( 18, 21) =   -21.99    
           dB_d2( 18, 22) =   -40.30    
           dB_d2( 18, 23) =    14.25    
           dB_d2( 18, 24) =   -10.94    
           dB_d2( 18, 25) =    14.59    
           dB_d2( 18, 26) =   -69.43    
           dB_d2( 18, 27) =   0.5435    
           dB_d2( 18, 28) =    7.380    
           dB_d2( 19,  1) =   -20.44    
           dB_d2( 19,  2) =    58.94    
           dB_d2( 19,  3) =   -2.115    
           dB_d2( 19,  4) =    23.43    
           dB_d2( 19,  5) =   -169.7    
           dB_d2( 19,  6) =    246.7    
           dB_d2( 19,  7) =    17.68    
           dB_d2( 19,  8) =   -77.35    
           dB_d2( 19,  9) =    70.34    
           dB_d2( 19, 10) =    74.04    
           dB_d2( 19, 11) =   -6.282    
           dB_d2( 19, 12) =   -16.71    
           dB_d2( 19, 13) =   -18.26    
           dB_d2( 19, 14) =    37.42    
           dB_d2( 19, 15) =   -12.99    
           dB_d2( 19, 16) =    23.64    
           dB_d2( 19, 17) =    34.69    
           dB_d2( 19, 18) =   -110.5    
           dB_d2( 19, 19) =   -18.13    
           dB_d2( 19, 20) =    67.88    
           dB_d2( 19, 21) =   -10.26    
           dB_d2( 19, 22) =   -6.815    
           dB_d2( 19, 23) =    13.50    
           dB_d2( 19, 24) =   -2.930    
           dB_d2( 19, 25) =   -2.985    
           dB_d2( 19, 26) =    44.84    
           dB_d2( 19, 27) =   -3.959    
           dB_d2( 19, 28) =   -26.21    
           dB_d2( 20,  1) =   -35.58    
           dB_d2( 20,  2) =    4.955    
           dB_d2( 20,  3) =    4.160    
           dB_d2( 20,  4) =   -17.72    
           dB_d2( 20,  5) =   -218.6    
           dB_d2( 20,  6) =    537.0    
           dB_d2( 20,  7) =    35.31    
           dB_d2( 20,  8) =   -99.43    
           dB_d2( 20,  9) =    122.3    
           dB_d2( 20, 10) =   -81.25    
           dB_d2( 20, 11) =   -19.90    
           dB_d2( 20, 12) =    21.11    
           dB_d2( 20, 13) =    14.81    
           dB_d2( 20, 14) =   -98.24    
           dB_d2( 20, 15) =   -16.74    
           dB_d2( 20, 16) =    11.45    
           dB_d2( 20, 17) =    25.65    
           dB_d2( 20, 18) =   -74.35    
           dB_d2( 20, 19) =   -3.118    
           dB_d2( 20, 20) =    14.98    
           dB_d2( 20, 21) =    17.15    
           dB_d2( 20, 22) =    28.10    
           dB_d2( 20, 23) =    6.340    
           dB_d2( 20, 24) =    8.680    
           dB_d2( 20, 25) =    22.66    
           dB_d2( 20, 26) =   -60.50    
           dB_d2( 20, 27) =   -16.88    
           dB_d2( 20, 28) =    42.08    
           dB_d2( 21,  1) =   -25.93    
           dB_d2( 21,  2) =    29.01    
           dB_d2( 21,  3) =    12.58    
           dB_d2( 21,  4) =   -34.07    
           dB_d2( 21,  5) =   -209.9    
           dB_d2( 21,  6) =    320.1    
           dB_d2( 21,  7) =    29.47    
           dB_d2( 21,  8) =   -38.47    
           dB_d2( 21,  9) =    142.8    
           dB_d2( 21, 10) =   -257.3    
           dB_d2( 21, 11) =   -14.61    
           dB_d2( 21, 12) =    75.33    
           dB_d2( 21, 13) =    21.94    
           dB_d2( 21, 14) =    20.20    
           dB_d2( 21, 15) =   -22.06    
           dB_d2( 21, 16) =    1.270    
           dB_d2( 21, 17) =    3.670    
           dB_d2( 21, 18) =    58.17    
           dB_d2( 21, 19) =   -2.059    
           dB_d2( 21, 20) =   -22.99    
           dB_d2( 21, 21) =   -9.255    
           dB_d2( 21, 22) =   -95.22    
           dB_d2( 21, 23) =    11.43    
           dB_d2( 21, 24) =    15.09    
           dB_d2( 21, 25) =    39.08    
           dB_d2( 21, 26) =  -0.1100    
           dB_d2( 21, 27) =   -8.288    
           dB_d2( 21, 28) =    23.39    
           dB_d2( 22,  1) =   -23.86    
           dB_d2( 22,  2) =    42.00    
           dB_d2( 22,  3) =    21.07    
           dB_d2( 22,  4) =   -26.39    
           dB_d2( 22,  5) =   -234.5    
           dB_d2( 22,  6) =    197.7    
           dB_d2( 22,  7) =    18.69    
           dB_d2( 22,  8) =    40.71    
           dB_d2( 22,  9) =    165.8    
           dB_d2( 22, 10) =   -147.3    
           dB_d2( 22, 11) =   -28.73    
           dB_d2( 22, 12) =    105.2    
           dB_d2( 22, 13) =    32.28    
           dB_d2( 22, 14) =   -77.19    
           dB_d2( 22, 15) =   -13.39    
           dB_d2( 22, 16) =    19.67    
           dB_d2( 22, 17) =  -0.2350    
           dB_d2( 22, 18) =    30.75    
           dB_d2( 22, 19) =   -9.337    
           dB_d2( 22, 20) =   -5.680    
           dB_d2( 22, 21) =   -35.06    
           dB_d2( 22, 22) =   -17.47    
           dB_d2( 22, 23) =    7.844    
           dB_d2( 22, 24) =   -9.615    
           dB_d2( 22, 25) =   -5.748    
           dB_d2( 22, 26) =    147.4    
           dB_d2( 22, 27) =    5.817    
           dB_d2( 22, 28) =   -11.23    
           dB_d2( 23,  1) =    21.86    
           dB_d2( 23,  2) =    23.08    
           dB_d2( 23,  3) =    6.370    
           dB_d2( 23,  4) =  -0.4550    
           dB_d2( 23,  5) =   -182.5    
           dB_d2( 23,  6) =    258.2    
           dB_d2( 23,  7) =    15.51    
           dB_d2( 23,  8) =    9.955    
           dB_d2( 23,  9) =    60.35    
           dB_d2( 23, 10) =    47.42    
           dB_d2( 23, 11) =    4.709    
           dB_d2( 23, 12) =   -67.86    
           dB_d2( 23, 13) =    74.50    
           dB_d2( 23, 14) =    12.13    
           dB_d2( 23, 15) =   -21.00    
           dB_d2( 23, 16) =   -46.75    
           dB_d2( 23, 17) =    41.56    
           dB_d2( 23, 18) =    39.67    
           dB_d2( 23, 19) =   -5.155    
           dB_d2( 23, 20) =   -3.290    
           dB_d2( 23, 21) =   -39.67    
           dB_d2( 23, 22) =    12.90    
           dB_d2( 23, 23) =    4.301    
           dB_d2( 23, 24) =   -5.235    
           dB_d2( 23, 25) =    1.005    
           dB_d2( 23, 26) =    38.47    
           dB_d2( 23, 27) =   -8.879    
           dB_d2( 23, 28) =    55.81  
       
           ! Fill mlat arrays:
           min_mlat(  1) =     45.00
           max_mlat(  1) =     47.00
           min_mlat(  2) =     47.00
           max_mlat(  2) =     49.00
           min_mlat(  3) =     49.00
           max_mlat(  3) =     51.00
           min_mlat(  4) =     51.00
           max_mlat(  4) =     53.00
           min_mlat(  5) =     53.00
           max_mlat(  5) =     55.00
           min_mlat(  6) =     55.00
           max_mlat(  6) =     57.00
           min_mlat(  7) =     57.00
           max_mlat(  7) =     59.00
           min_mlat(  8) =     59.00
           max_mlat(  8) =     61.00
           min_mlat(  9) =     61.00
           max_mlat(  9) =     63.00
           min_mlat( 10) =     63.00
           max_mlat( 10) =     65.00
           min_mlat( 11) =     65.00
           max_mlat( 11) =     67.00
           min_mlat( 12) =     67.00
           max_mlat( 12) =     69.00
           min_mlat( 13) =     69.00
           max_mlat( 13) =     71.00
           min_mlat( 14) =     71.00
           max_mlat( 14) =     73.00
           min_mlat( 15) =     73.00
           max_mlat( 15) =     75.00
           min_mlat( 16) =     75.00
           max_mlat( 16) =     77.00
           min_mlat( 17) =     77.00
           max_mlat( 17) =     79.00
           min_mlat( 18) =     79.00
           max_mlat( 18) =     81.00
           min_mlat( 19) =     81.00
           max_mlat( 19) =     83.00
           min_mlat( 20) =     83.00
           max_mlat( 20) =     85.00
           min_mlat( 21) =     85.00
           max_mlat( 21) =     87.00
           min_mlat( 22) =     87.00
           max_mlat( 22) =     89.00
           min_mlat( 23) =     89.00
           max_mlat( 23) =     91.00
       
         end subroutine B_b0_fill_coeff_arrays
       
       end module B_b0_coeffmerge_mod
       
       !---------------------------------------------------------------------------
       !---------------------------------------------------------------------------
       
       subroutine B_b0_calc_model_value(mlat_glob,mlt, 
     |       sinT,imf_angle,btrans,
     |       value_Ed1,value_Ed2,value,value_found,FAC_value)
       
         ! This version is for public distribution, along with the module
         ! file coeff_mod.f90.
         !
         ! Within the /home/hensel/fortran/fit_data/public subdirectory,
         ! this program is called by call_de2_model.
       
         use common_model_mod,only: MMX,MXNMX,ITHMX, 
     |         mlat_resolution
       
         use B_b0_model_mod,only: 
     |       pi,find_Btrans_function,find_imf_angle_function,
     |       find_sint_function
       
         use B_b0_model_mod,only:  B_B0_number_of_MLT_coeffs,
     |       B_B0_number_of_Btrans_coeffs, 
     |       B_B0_number_of_imf_angle_coeffs,
     |       B_B0_number_of_sinT_coeffs,value_dummy,
     |       AO => B_B0_AO,Q => B_B0_Q,DQ => B_B0_DQ,
     |       fit_by_Btrans => B_B0_fit_by_Btrans,fit_by_imf_angle => 
     |       B_B0_fit_by_imf_angle,fit_by_sinT => B_B0_fit_by_sinT,
     |       FAC_AO => B0_FAC_AO
       
         use qgen_mod,only: RI,ST,IBM,IEM,mcoef,dth,ns
       
         implicit none
       
         real, intent(in) :: mlat_glob,mlt,sinT,imf_angle,btrans
         real, intent(out) :: value_Ed1,value_Ed2,value
         logical, intent(out) :: value_found
         real, intent(out) :: FAC_value
       
         integer :: ith,m,k,ix,mm,iBtrans,iIMF_angle,isinT,fit_count,
     |         iMLT
         integer :: m2iMLT(B_B0_number_of_MLT_coeffs)
         data m2iMLT /0,-1,1,-2,2,-3,3/ 
         real :: mlat,poten,etheta,ephi,FAC_poten,
     |        x,xm1,xp1,xp2,x0,sp,cp,sts,rst,qsoso,qsost,
     |        Btrans_function,imf_angle_function,sint_function
         real :: QS(-MMX:MMX,MXNMX),DQS(-MMX:MMX,MXNMX),F(-MMX:MMX)
         real :: fac_Y,Y,sinIm,get_sinIm
       
         ! General:
         logical, parameter :: debug = .false.
       
         !****************************************************************
         ! Interpolate to get coefficients for specified mlat:
         !****************************************************************
       
         value_found = .false.
         value_dummy = .true.
       
         ! Use absolute value of mlat:
         mlat = abs(mlat_glob)
       
         ! C Construct electric potential and electric field components 
         !C   (etheta equatorward, ephi eastward) 
         !C   on 2x10 degree grid, 0-40 colatitude
         !C Colatitudes (degrees) are in CLATD(0:ITHPLT)
         !C MLTs (hours) are in MLT(0:24)
         poten  = 0.
         etheta = 0.
         ephi   = 0.
         FAC_poten = 0.
         !C Calculate multipliers for cubic interpolation between latitudes where
         !C  Q, DQ are available
         X = (90.-mlat)*pi/180./DTH
         ITH = X
         ITH = MAX0(1,MIN0(ITHMX-2,ITH))
         X   = X - ITH
         XM1 = X*(-2. + X*(3. - X))/6.
         X0  = 1. + X*(-.5 + X*(-1. + .5*X))
         XP1 = X*(1. + X*(.5 - .5*X))
         XP2 = X*(-1. + X*X)/6.
       
         sp = sin(MLT*pi/12.)
         cp = COS(MLT*pi/12.)
         call FCMP_single(MMX,CP,SP,F)
       
         sts =  XM1* ST(ITH-1)+X0*ST(ITH)+ XP1*ST(ITH+1)+XP2*ST(ITH+2)   
       
         rst = RI*STS                                
         do iMLT = 1,B_B0_number_of_MLT_coeffs 
            m = m2iMLT(iMLT) 						     
            MM = IABS(M)
       
            Btrans_loop1:do iBtrans=1,1+(fit_by_Btrans
     |            *B_B0_number_of_Btrans_coeffs - fit_by_Btrans)
               Btrans_function = find_Btrans_function (iBtrans,Btrans)	 
               imf_angle_loop1:do iimf_angle=1,1+(fit_by_imf_angle
     |               *B_B0_number_of_imf_angle_coeffs -fit_by_imf_angle)
                  imf_angle_function =  
     |                find_imf_angle_function (iimf_angle,imf_angle) 
                   sint_loop1:do isint=1,1+(fit_by_sint
     |                  *B_B0_number_of_sint_coeffs - fit_by_sint)
                     sint_function = find_sint_function (isint,sint)   
       
       	      do K=1,	MXNMX					     
                        IX = K - 1						
                        QS(M,K) = XM1*Q(2*IX+NS(MM),ITH-1)+ 
     |                      X0*Q(2*IX+NS(MM),ITH) 
     |                      +XP1*Q(2*IX+NS(MM),ITH+1)+ 
     |                      XP2*Q(2*IX+NS(MM),ITH+2)
                        DQS(M,K) = XM1*DQ(2*IX+NS(MM),ITH-1)+ 
     |                      X0*DQ(2*IX+NS(MM),ITH)
     |                      +XP1*DQ(2*IX+NS(MM),ITH+1)+ 
     |                      XP2*DQ(2*IX+NS(MM),ITH+2)   
                        IF (ITH.GT.0) THEN
                           qsost = QS(M,K)/STS
                        ELSE
                           qsost = DQS(M,K)
                        ENDIF
                        poten  = poten  +  
     |                     AO(M,K,iBtrans,iimf_angle,isint)*
     |                     QS(M,K)*F(M)*
     |                     Btrans_function*imf_angle_function*
     |                     sint_function
                        etheta = etheta +  
     |                     AO(M,K,iBtrans,iimf_angle,isint)*
     |                     DQS(M,K)*F(M)/RI*
     |                     Btrans_function*imf_angle_function*
     |                     sint_function
                        ephi   = ephi	-  
     |                     AO(M,K,iBtrans,iimf_angle,isint)*
     |                     qsost*M*F(-M)/RI*
     |                     Btrans_function*imf_angle_function*
     |                     sint_function 
                        FAC_poten  = FAC_poten  +  
     |                     FAC_AO(M,K,iBtrans,iimf_angle,isint)* 
     |                     QS(M,K)*F(M)*
     |                     Btrans_function*imf_angle_function* 
     |                     sint_function 
                     enddo
                  end do sint_loop1
               end do imf_angle_loop1
            end do Btrans_loop1
         enddo
       
         sinIm =  get_sinIm(mlat)  
         value     = poten
         FAC_value = FAC_poten
         value_Ed1 =  etheta/abs(sin(mlat*pi/180.))  ! dBd1
         value_Ed2 =  ephi/sqrt(0.25+0.75*      ! dBd2
     |         sin(mlat*pi/180.)**2)
       
         value_found = .true.
         value_dummy = .false.
         if (debug) then
            write(*,'(" for mlat=",F9.2,", MLT=",F9.2,":  ",G14.6)') 
     |            mlat,MLT*180./24.,value
         end if
       
       end subroutine B_b0_calc_model_value
       
       !---------------------------------------------------------------------------
       !---------------------------------------------------------------------------
       
       subroutine B_b0_set_coeff_array
       
         use common_model_mod, only: nmlat,average_mlat
         use B_b0_coeffmerge_mod, only: dB_d1,dB_d2,
     |         B_b0_fill_coeff_arrays
         use B_b0_model_mod, only: nfit => B_B0_nfit, 
     |         b_Ed1 => B_B0_b_Ed1,b_Ed2 => B_B0_b_Ed2,b_interp_Ed1,
     |          b_interp_Ed2,b_90_Ed1,b_90_Ed2,x,imlat,ifit,
     |         B_B0_number_of_MLT_coeffs,
     |         B_B0_number_of_Btrans_coeffs,
     |         B_B0_number_of_imf_angle_coeffs,
     |         B_B0_number_of_sinT_coeffs,
     |         fit_by_MLT,pi,
     |          fit_by_Btrans => B_B0_fit_by_Btrans, 
     |          fit_by_imf_angle => B_B0_fit_by_imf_angle, 
     |          fit_by_sinT => B_B0_fit_by_sinT        
       
         integer :: binary_fit_by,check_dim
         integer :: iMLT,iBtrans,iimf_angle,isinT,fit_count
         real :: fac_ed1, fac_ed2, colat
         real :: fac_Y,Y
       
         !****************************************************************
         ! Fill parameter arrays:
         !****************************************************************
         call B_b0_fill_coeff_arrays
       
         !****************************************************************
         ! Determine array dimensions.  Arrays for data type 'potential'
         ! are the same size as arrays for other data types.
         !****************************************************************
       
         nmlat = size(dB_d1,1)
         nfit  = size(dB_d1,2)
       
         ! check dimensions
         check_dim = B_B0_number_of_MLT_coeffs* 
     |         B_B0_number_of_Btrans_coeffs*
     |          B_B0_number_of_imf_angle_coeffs* 
     |         B_B0_number_of_sinT_coeffs
         if(check_dim /= nfit) then
            write(6,'("choose_coeff_array: wrong dimensions ", 2i4)') 
     |            nfit,check_dim
            stop
         endif
         !****************************************************************
         ! Allocate arrays into which coefficients will be transferred:
         !****************************************************************
         allocate(b_Ed1(nmlat,nfit),b_Ed2(nmlat,nfit), 
     |         b_interp_Ed1(nfit),
     |         b_interp_Ed2(nfit),x(nfit),
     |         b_90_Ed1(nfit),b_90_Ed2(nfit))
       
         !****************************************************************
         ! Transfer values:
         !****************************************************************
       
         do imlat=1,nmlat
            do ifit=1,nfit
               if(abs(dB_d1(imlat,ifit)) >= 0.5000E+17)  
     |            dB_d1(imlat,ifit)=0.
               if(abs(dB_d2(imlat,ifit)) >= 0.5000E+17)  
     |           dB_d2(imlat,ifit)=0.
       
               b_Ed1(imlat,ifit)=abs(sin(average_mlat(imlat)*pi/180.))*
     |             dB_d2(imlat,ifit)/2**0.5
               b_Ed2(imlat,ifit)=sqrt(0.25+0.75*
     |             sin(average_mlat(imlat)*pi/180.)**2)* 
     |             dB_d1(imlat,ifit)/2**0.5
            end do
         end do
       
       end subroutine B_b0_set_coeff_array
                                                                             
